<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Geva Kipper — Brain-Scan Console</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#0b0f12;
      --bg1:#0f151a;
      --ink:#e8f1f4;
      --muted:#b6c4cb;
      --grid: rgba(255,255,255,.06);
      --glass: rgba(18, 26, 32, .52);
      --glass2: rgba(10, 14, 18, .38);
      --border: rgba(165, 235, 255, .18);

      --teal: hsl(187 90% 56%);
      --cyan: hsl(172 88% 56%);
      --violet: hsl(269 92% 70%);
      --amber: hsl(36 90% 60%);

      /* daily-variant controlled parameters (set by JS) */
      --signal: var(--teal);
      --signal2: var(--cyan);
      --signalGlow: rgba(90, 245, 255, .38);
      --brainShiftX: 0px;
      --brainShiftY: 0px;
      --noiseOpacity: .22;
      --regionJitter: 0px;
      --dockWidth: 370px;

      --hudH: 82px;
      --footerH: 44px;
      --r: 14px;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      --display: "Space Grotesk", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    *{ box-sizing:border-box; }
    html, body { height: 100%; }
    html { scroll-behavior:smooth; }
    body{
      margin:0;
      color: var(--ink);
      font-family: var(--sans);
      background:
        radial-gradient(1100px 700px at 50% 40%, rgba(56, 190, 210, .08), transparent 60%),
        radial-gradient(900px 600px at 65% 55%, rgba(170, 110, 255, .08), transparent 62%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* subtle scan vignette */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(1200px 900px at 50% 45%, transparent 35%, rgba(0,0,0,.55) 78%),
        linear-gradient(180deg, rgba(0,0,0,.38), transparent 35%, rgba(0,0,0,.52));
      mix-blend-mode: multiply;
      z-index: 1;
    }

    /* animated noise canvas */
    #noiseWrap{
      position:fixed;
      inset:0;
      z-index: 0;
      pointer-events:none;
      opacity: var(--noiseOpacity);
      mix-blend-mode: overlay;
      filter: contrast(105%) brightness(110%);
    }
    #noise{
      width:100%;
      height:100%;
      display:block;
    }

    /* Header HUD */
    header.hud{
      position:fixed;
      top:0; left:0; right:0;
      height: var(--hudH);
      z-index: 10;
      display:grid;
      grid-template-columns: 1fr minmax(240px, 420px) 1fr;
      gap: 16px;
      padding: 14px 18px;
      align-items:center;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(9,12,15,.76), rgba(9,12,15,.34));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }

    .hud-left{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width: 260px;
    }
    .hud-left .nameRow{
      display:flex;
      align-items:center;
      gap:10px;
      font-family: var(--display);
      letter-spacing:.3px;
    }
    .name{
      font-weight:700;
      font-size: 17px;
      line-height:1;
    }
    .statusDot{
      width: 9px; height: 9px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--signal));
      box-shadow: 0 0 16px rgba(90,245,255,.55);
      position:relative;
    }
    .statusDot::after{
      content:"";
      position:absolute;
      inset:-8px;
      border-radius:50%;
      border:1px solid rgba(90,245,255,.20);
      animation: pulse 2.6s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform:scale(.86); opacity:.35; }
      50%{ transform:scale(1.12); opacity:.65; }
    }
    .role{
      font-size: 12.5px;
      color: rgba(232,241,244,.78);
      line-height:1.25;
    }

    .hud-right{
      justify-self:end;
      text-align:right;
      color: rgba(232,241,244,.68);
      font-size: 12.5px;
      font-style: italic;
      max-width: 380px;
    }

    #eeg{
      width: 100%;
      height: 36px;
      border-radius: 10px;
      background:
        linear-gradient(90deg, rgba(255,255,255,.04), rgba(255,255,255,.01)),
        linear-gradient(0deg, rgba(255,255,255,.04), transparent 50%, rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.06);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.20);
    }

    /* Main console */
    main{
      position:relative;
      z-index: 2;
      padding-top: calc(var(--hudH) + 10px);
      padding-bottom: calc(var(--footerH) + 18px);
      min-height: 100vh;
    }

    .console{
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px 16px 26px;
    }

    .neuralLayout{
      position:relative;
      display:grid;
      grid-template-columns: 1fr var(--dockWidth);
      gap: 16px;
      align-items: stretch;
      min-height: calc(100vh - var(--hudH) - var(--footerH) - 60px);
    }

    .map{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.06));
      border: 1px solid rgba(255,255,255,.06);
      box-shadow:
        0 18px 50px rgba(0,0,0,.35),
        inset 0 0 0 1px rgba(0,0,0,.25);
    }

    /* micro-grid in map */
    .map::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background:
        linear-gradient(to right, rgba(255,255,255,.05) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,.05) 1px, transparent 1px);
      background-size: 36px 36px;
      opacity: .08;
      mask-image: radial-gradient(700px 480px at 50% 48%, rgba(0,0,0,1), rgba(0,0,0,.1) 70%, transparent 85%);
      -webkit-mask-image: radial-gradient(700px 480px at 50% 48%, rgba(0,0,0,1), rgba(0,0,0,.1) 70%, transparent 85%);
    }

    .mapInner{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 12px;
    }

    /* Brain SVG */
    #brain{
      width: min(820px, 96%);
      height: auto;
      display:block;
      transform: translate(var(--brainShiftX), var(--brainShiftY));
      filter: drop-shadow(0 0 18px rgba(90,245,255,.08));
      transition: transform .18s ease-out;
    }

    .brainContours{
      opacity: .95;
    }

    .contour{
      fill:none;
      stroke: var(--signal);
      stroke-width: 2.2;
      opacity:.80;
      filter: url(#glow);
    }
    .contour.soft{
      stroke: var(--signal2);
      stroke-width: 1.6;
      opacity:.55;
    }
    .contour.thin{
      stroke: rgba(165,235,255,.42);
      stroke-width: 1.1;
      opacity:.45;
    }

    /* gentle contour pulse */
    .brainContours{
      animation: contourPulse 4.8s ease-in-out infinite;
      transform-origin: 50% 50%;
    }
    @keyframes contourPulse{
      0%,100%{ opacity:.86; }
      50%{ opacity:1; }
    }

    /* Regions */
    .regions .region{
      cursor: pointer;
      user-select:none;
      outline: none;
    }

    .regions .hit{
      fill: rgba(0,0,0,0);
      stroke: rgba(255,255,255,0);
      stroke-width: 26;
      pointer-events: stroke;
    }

    .regions .dot{
      fill: rgba(232,241,244,.88);
      opacity: .8;
    }

    .regions .label{
      font-family: var(--display);
      font-size: 12px;
      letter-spacing: .55px;
      fill: rgba(232,241,244,.78);
      paint-order: stroke;
      stroke: rgba(0,0,0,.55);
      stroke-width: 3px;
      opacity: .86;
    }

    .regionHint{
      fill: none;
      stroke: rgba(90,245,255,.40);
      stroke-width: 1.2;
      opacity: 0;
      transition: opacity .15s ease-out, r .15s ease-out;
      filter: url(#glow2);
    }

    .regionsDim .region:not(.active){
      opacity: .30;
      filter: saturate(.8);
    }

    .region.active .dot{
      fill: var(--signal);
      opacity: 1;
      filter: url(#glow2);
    }
    .region.active .label{
      fill: rgba(232,241,244,.92);
    }

    /* synaptic line */
    .synapse{
      fill:none;
      stroke: rgba(90,245,255,.55);
      stroke-width: 2.0;
      stroke-linecap: round;
      stroke-dasharray: 7 7;
      opacity: 0;
      filter: url(#glow2);
      transition: opacity .18s ease;
    }

    /* Dock panel */
    aside.dock{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.06);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(0,0,0,.10));
      box-shadow:
        0 18px 50px rgba(0,0,0,.30),
        inset 0 0 0 1px rgba(0,0,0,.25);
      min-height: 520px;
    }

    .dock::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(420px 260px at 20% 10%, rgba(90,245,255,.09), transparent 60%),
        radial-gradient(460px 280px at 80% 20%, rgba(170,110,255,.08), transparent 55%),
        linear-gradient(to right, rgba(255,255,255,.06) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,.05) 1px, transparent 1px);
      background-size: auto, auto, 28px 28px, 28px 28px;
      opacity: .85;
    }

    .panel{
      position:absolute;
      inset: 0;
      padding: 14px 14px 12px;
      display:flex;
      flex-direction:column;
      gap: 12px;
    }

    .panelCard{
      border-radius: 16px;
      background: rgba(14, 20, 25, .55);
      border: 1px solid var(--border);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 14px 14px 12px;
      box-shadow:
        0 18px 45px rgba(0,0,0,.28),
        inset 0 0 0 1px rgba(0,0,0,.25);
      position:relative;
      overflow:hidden;
    }

    /* micro-grid texture in cards */
    .panelCard::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background:
        linear-gradient(to right, rgba(255,255,255,.06) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,.05) 1px, transparent 1px);
      background-size: 22px 22px;
      opacity: .09;
      mask-image: radial-gradient(420px 240px at 15% 0%, rgba(0,0,0,1), transparent 70%);
      -webkit-mask-image: radial-gradient(420px 240px at 15% 0%, rgba(0,0,0,1), transparent 70%);
    }

    .panelMeta{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
      position:relative;
      z-index:1;
    }

    .panelTitle{
      font-family: var(--display);
      font-weight: 700;
      letter-spacing: .6px;
      font-size: 18px;
      margin:0;
      line-height:1.1;
    }

    .panelKicker{
      font-family: var(--mono);
      font-size: 11.5px;
      letter-spacing: .14em;
      color: rgba(232,241,244,.62);
      text-transform: uppercase;
      margin-top: 2px;
    }

    .panelSummary{
      color: rgba(232,241,244,.82);
      font-size: 13px;
      line-height:1.35;
      margin: 8px 0 0 0;
      position:relative;
      z-index:1;
    }

    .tags{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top: 10px;
      position:relative;
      z-index:1;
    }
    .tag{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(232,241,244,.78);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      padding: 5px 9px;
      background: rgba(0,0,0,.14);
      backdrop-filter: blur(6px);
    }

    .actions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top: 12px;
      position:relative;
      z-index:1;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(165,235,255,.22);
      background: rgba(12, 18, 22, .35);
      color: rgba(232,241,244,.92);
      text-decoration:none;
      font-size: 12.5px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      white-space:nowrap;
    }
    .pill:hover{
      transform: translateY(-1px);
      border-color: rgba(90,245,255,.42);
      background: rgba(12, 18, 22, .50);
    }
    .pill.primary{
      border-color: rgba(90,245,255,.45);
      box-shadow: 0 0 0 1px rgba(90,245,255,.15), 0 10px 22px rgba(0,0,0,.25);
    }
    .pill.violet{
      border-color: rgba(170,110,255,.35);
    }
    .pill.amber{
      border-color: rgba(255,198,105,.30);
      color: rgba(255, 232, 200, .92);
    }

    /* panel state (preview vs pinned) */
    .isPreview .panelCard{
      filter: blur(1.2px) saturate(.95);
      opacity: .86;
      transform: translateY(2px) scale(.995);
      transition: opacity .12s ease, filter .12s ease, transform .12s ease;
    }
    .isPinned .panelCard{
      opacity: 1;
      filter: none;
      transform: none;
    }
    .panelNotice{
      font-size: 11.5px;
      color: rgba(232,241,244,.60);
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px dashed rgba(255,255,255,.10);
      background: rgba(0,0,0,.08);
      position:relative;
      z-index:1;
    }

    /* MOTIFS (unique per region) */
    .motif{
      position:absolute;
      inset:-40px -40px auto auto;
      width: 320px;
      height: 220px;
      pointer-events:none;
      opacity:.85;
      filter: saturate(1.05);
      z-index:0;
    }

    /* waveform */
    .motif-wave path{
      stroke: rgba(90,245,255,.25);
      stroke-width: 2;
      fill:none;
    }

    /* heatmap */
    .heatmap{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:.55;
      z-index:0;
      background:
        radial-gradient(180px 120px at 20% 35%, rgba(90,245,255,.26), transparent 65%),
        radial-gradient(220px 160px at 70% 30%, rgba(170,110,255,.22), transparent 60%),
        radial-gradient(220px 160px at 55% 75%, rgba(255,198,105,.18), transparent 60%);
      filter: blur(10px) saturate(1.08);
      animation: heatShift 10.5s ease-in-out infinite;
    }
    @keyframes heatShift{
      0%,100%{ transform: translate3d(-6px, 2px, 0) scale(1.03); }
      50%{ transform: translate3d(9px, -4px, 0) scale(1.08); }
    }

    /* polygon + arrow */
    .polyWrap{
      position:absolute;
      right:-8px; top:-10px;
      width: 230px; height: 230px;
      opacity:.7;
      z-index:0;
      pointer-events:none;
    }
    .polyWrap svg{
      width:100%; height:100%;
      animation: polySpin 14s linear infinite;
      transform-origin: 50% 50%;
      filter: drop-shadow(0 0 12px rgba(90,245,255,.10));
    }
    @keyframes polySpin{ to{ transform: rotate(360deg); } }
    .arrowPath{
      stroke: rgba(90,245,255,.30);
      stroke-width: 2;
      fill:none;
      stroke-dasharray: 6 10;
      animation: dash 6s linear infinite;
    }
    @keyframes dash{
      to{ stroke-dashoffset: -64; }
    }

    /* speech bubble + rating bar */
    .bubble{
      position:absolute;
      right: 14px;
      top: 12px;
      width: 160px;
      height: 110px;
      opacity:.72;
      z-index:0;
      pointer-events:none;
    }
    .rating{
      height: 10px;
      border-radius: 999px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      position:relative;
      margin-top: 12px;
    }
    .rating::before{
      content:"";
      position:absolute;
      inset:0;
      width: 62%;
      background: linear-gradient(90deg, rgba(90,245,255,.0), rgba(90,245,255,.35), rgba(170,110,255,.28));
      animation: rateGlow 3.4s ease-in-out infinite;
    }
    @keyframes rateGlow{
      0%,100%{ transform: translateX(-8%); opacity:.65; }
      50%{ transform: translateX(10%); opacity:.95; }
    }

    /* rhymes slanted lines */
    .rhymesLines{
      position:absolute;
      inset: -20px -30px auto auto;
      width: 320px;
      height: 220px;
      opacity:.55;
      pointer-events:none;
      z-index:0;
      background:
        repeating-linear-gradient( -14deg,
          rgba(90,245,255,.0) 0px,
          rgba(90,245,255,.0) 10px,
          rgba(90,245,255,.20) 10px,
          rgba(90,245,255,.20) 11px
        );
      mask-image: radial-gradient(240px 170px at 55% 45%, rgba(0,0,0,1), transparent 75%);
      -webkit-mask-image: radial-gradient(240px 170px at 55% 45%, rgba(0,0,0,1), transparent 75%);
      animation: rhymeDrift 9.5s ease-in-out infinite;
    }
    @keyframes rhymeDrift{
      0%,100%{ transform: translate3d(4px, 3px, 0); opacity:.52; }
      50%{ transform: translate3d(-7px, -5px, 0); opacity:.66; }
    }

    /* recursive card */
    .recursive{
      position:absolute;
      right: 12px;
      top: 10px;
      width: 170px;
      height: 120px;
      opacity:.85;
      z-index:0;
      pointer-events:none;
    }
    .recursive .frame{
      position:absolute;
      inset: 0;
      border-radius: 14px;
      border: 1px solid rgba(90,245,255,.18);
      background: rgba(0,0,0,.10);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.25);
    }
    .recursive .frame:nth-child(2){
      inset: 14px 16px 16px 14px;
      border-color: rgba(170,110,255,.20);
      background: rgba(0,0,0,.14);
      transform: rotate(-1deg);
    }
    .recursive .frame:nth-child(3){
      inset: 32px 34px 32px 32px;
      border-color: rgba(90,245,255,.18);
      background: rgba(0,0,0,.16);
      transform: rotate(1.5deg);
    }

    /* connectome */
    .connectome{
      position:absolute;
      right: 6px;
      top: 6px;
      width: 220px;
      height: 160px;
      opacity:.82;
      z-index:0;
      pointer-events:none;
    }
    .connectBtnRow{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
      position:relative;
      z-index:1;
    }
    .iconBtn{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:8px;
      text-decoration:none;
      color: rgba(232,241,244,.92);
      padding: 10px 8px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      transition: transform .12s ease, border-color .12s ease;
      min-height: 78px;
    }
    .iconBtn:hover{
      transform: translateY(-1px);
      border-color: rgba(90,245,255,.35);
    }
    .icon{
      width: 24px; height: 24px;
      opacity: .9;
      filter: drop-shadow(0 0 10px rgba(90,245,255,.10));
    }
    .iconLabel{
      font-size: 12px;
      color: rgba(232,241,244,.78);
      font-family: var(--display);
      letter-spacing: .2px;
    }

    /* Footer Diagnostics */
    footer.diag{
      position:fixed;
      bottom:0; left:0; right:0;
      height: var(--footerH);
      z-index: 9;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 0 14px;
      background: linear-gradient(0deg, rgba(9,12,15,.82), rgba(9,12,15,.30));
      border-top: 1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      font-size: 11.5px;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: rgba(232,241,244,.62);
    }
    .diag .left{
      display:flex;
      align-items:center;
      gap: 10px;
      white-space:nowrap;
    }
    .divider{
      width: 34px;
      height: 1px;
      background: rgba(255,255,255,.14);
    }
    .uptime{
      font-family: var(--mono);
      font-size: 12px;
      letter-spacing: .10em;
      color: rgba(232,241,244,.76);
      text-transform:none;
      text-shadow: 0 0 18px rgba(90,245,255,.12);
      white-space:nowrap;
    }

    /* Mobile bottom sheet */
    .sheet{
      display:none;
      position:fixed;
      left: 10px;
      right: 10px;
      bottom: calc(var(--footerH) + 10px);
      z-index: 11;
      border-radius: 18px;
      overflow:hidden;
      transform: translateY(120%);
      transition: transform .22s ease;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(12, 17, 21, .40);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 0 20px 60px rgba(0,0,0,.50);
    }
    .sheet.open{ transform: translateY(0); }
    .sheetTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.06);
      background: rgba(0,0,0,.12);
    }
    .grab{
      width: 44px;
      height: 4px;
      border-radius:999px;
      background: rgba(255,255,255,.18);
      margin: 0 auto;
    }
    .sheetClose{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.10);
      color: rgba(232,241,244,.80);
      border-radius: 12px;
      padding: 6px 10px;
      font-family: var(--display);
      font-size: 12px;
      cursor:pointer;
    }
    .sheetBody{
      padding: 10px 10px 12px;
    }

    /* helper */
    .kbd{
      font-family: var(--mono);
      font-size: 11px;
      border:1px solid rgba(255,255,255,.12);
      padding: 1px 6px;
      border-radius: 8px;
      background: rgba(0,0,0,.12);
      color: rgba(232,241,244,.70);
    }

    /* Responsive */
    @media (max-width: 900px){
      :root{ --dockWidth: 340px; }
      header.hud{ grid-template-columns: 1fr minmax(200px, 320px) 1fr; }
      .hud-right{ max-width: 260px; }
    }
    @media (max-width: 820px){
      .neuralLayout{
        grid-template-columns: 1fr;
      }
      aside.dock{ display:none; }
      .sheet{ display:block; }
      header.hud{ grid-template-columns: 1fr; height: auto; padding: 12px 14px; gap: 10px; }
      .hud-right{ justify-self:start; text-align:left; }
      #eeg{ height: 28px; }
      :root{ --hudH: 124px; }
    }
  </style>
</head>

<body>
  <div id="noiseWrap"><canvas id="noise"></canvas></div>

  <header class="hud" aria-label="Header HUD">
    <div class="hud-left">
      <div class="nameRow">
        <div class="name">Geva Kipper</div>
        <div class="statusDot" aria-hidden="true"></div>
      </div>
      <div class="role">Software engineer at Google, currently building and scaling production systems.</div>
    </div>

    <canvas id="eeg" width="820" height="72" aria-hidden="true"></canvas>

    <div class="hud-right">
      This portfolio is re-designed each day by AI—an ever-changing interface.
    </div>
  </header>

  <main>
    <div class="console">
      <div class="neuralLayout">
        <section class="map" aria-label="Neural Map">
          <div class="mapInner">
            <svg id="brain" viewBox="0 0 900 600" role="img" aria-label="Brain scan neural map">
              <defs>
                <filter id="glow" x="-40%" y="-40%" width="180%" height="180%">
                  <feGaussianBlur stdDeviation="3.4" result="b"/>
                  <feColorMatrix in="b" type="matrix" values="
                    1 0 0 0 0
                    0 1 0 0 0
                    0 0 1 0 0
                    0 0 0 .55 0" result="g"/>
                  <feMerge>
                    <feMergeNode in="g"/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
                <filter id="glow2" x="-40%" y="-40%" width="180%" height="180%">
                  <feGaussianBlur stdDeviation="2.0" result="b"/>
                  <feMerge>
                    <feMergeNode in="b"/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
              </defs>

              <!-- synaptic connection line -->
              <path id="synapsePath" class="synapse" d=""></path>

              <!-- brain contours (stylized silhouette + inner sulci) -->
              <g class="brainContours" id="brainContours">
                <!-- outer silhouette (stylized brain-like outline) -->
                <path class="contour" d="
                  M 265 325
                  C 240 285, 245 230, 285 195
                  C 320 165, 365 155, 405 168
                  C 425 130, 490 118, 545 140
                  C 590 158, 620 192, 632 238
                  C 675 260, 690 315, 665 355
                  C 688 420, 645 470, 585 477
                  C 555 508, 505 520, 465 505
                  C 420 530, 360 525, 328 490
                  C 275 480, 245 430, 264 382
                  C 238 365, 238 342, 265 325
                  Z" />

                <!-- inner contours -->
                <path class="contour soft" d="
                  M 315 255
                  C 340 230, 380 224, 414 236
                  C 452 250, 470 280, 466 310
                  C 460 350, 415 372, 382 358
                  C 342 342, 305 295, 315 255 Z" />

                <path class="contour thin" d="
                  M 470 205
                  C 500 190, 545 198, 566 225
                  C 592 255, 582 296, 552 312
                  C 522 328, 480 320, 466 292
                  C 454 268, 446 218, 470 205 Z" />

                <path class="contour thin" d="
                  M 340 405
                  C 370 380, 420 380, 455 402
                  C 490 424, 498 456, 478 476
                  C 450 505, 392 500, 360 476
                  C 330 454, 320 430, 340 405 Z" />

                <path class="contour soft" d="
                  M 525 360
                  C 555 340, 595 342, 610 372
                  C 625 400, 602 430, 572 438
                  C 542 446, 515 430, 510 405
                  C 505 382, 510 370, 525 360 Z" />
              </g>

              <!-- Regions (positions slightly jittered daily by JS) -->
              <g class="regions" id="regions">
                <!-- Auditory Cortex -> GlglStats -->
                <g class="region" data-id="glgl" tabindex="0" role="button" aria-label="Auditory Cortex — GlglStats">
                  <circle class="hit" cx="630" cy="240" r="20"></circle>
                  <circle class="dot" cx="630" cy="240" r="3.6"></circle>
                  <text class="label" x="650" y="235">AUDITORY</text>
                </g>

                <!-- Spatial/Navigation -> Ahuzat Dibuk -->
                <g class="region" data-id="parking" tabindex="0" role="button" aria-label="Spatial navigation — Ahuzat Dibuk">
                  <circle class="hit" cx="600" cy="410" r="20"></circle>
                  <circle class="dot" cx="600" cy="410" r="3.6"></circle>
                  <text class="label" x="622" y="414">SPATIAL</text>
                </g>

                <!-- Motor Planning -> 2D Part Orienting -->
                <g class="region" data-id="orient" tabindex="0" role="button" aria-label="Motor planning — 2D Part Orienting">
                  <circle class="hit" cx="470" cy="495" r="20"></circle>
                  <circle class="dot" cx="470" cy="495" r="3.6"></circle>
                  <text class="label" x="492" y="500">MOTOR</text>
                </g>

                <!-- Language & Humor -> The Turing Jest -->
                <g class="region" data-id="jest" tabindex="0" role="button" aria-label="Language and humor — The Turing Jest">
                  <circle class="hit" cx="330" cy="250" r="20"></circle>
                  <circle class="dot" cx="330" cy="250" r="3.6"></circle>
                  <text class="label" x="205" y="250">LANG / HUMOR</text>
                </g>

                <!-- Creative Rewrite -> Rhymes of Israel -->
                <g class="region" data-id="rhymes" tabindex="0" role="button" aria-label="Creative rewrite — Rhymes of Israel">
                  <circle class="hit" cx="300" cy="390" r="20"></circle>
                  <circle class="dot" cx="300" cy="390" r="3.6"></circle>
                  <text class="label" x="176" y="394">REWRITE</text>
                </g>

                <!-- Self-Model/Meta -> portfolio -->
                <g class="region" data-id="meta" tabindex="0" role="button" aria-label="Self model meta — Portfolio">
                  <circle class="hit" cx="455" cy="330" r="22"></circle>
                  <circle class="dot" cx="455" cy="330" r="4.0"></circle>
                  <text class="label" x="470" y="322">META</text>
                </g>

                <!-- Connectome -> Links -->
                <g class="region" data-id="connect" tabindex="0" role="button" aria-label="Connectome — social links">
                  <circle class="hit" cx="690" cy="315" r="20"></circle>
                  <circle class="dot" cx="690" cy="315" r="3.6"></circle>
                  <text class="label" x="714" y="320">CONNECTOME</text>
                </g>

                <circle id="regionHint" class="regionHint" cx="0" cy="0" r="16"></circle>
              </g>
            </svg>
          </div>
        </section>

        <aside class="dock" aria-label="Docked region report panel">
          <div class="panel" id="dockPanel">
            <!-- populated by JS -->
          </div>
        </aside>
      </div>
    </div>
  </main>

  <!-- Mobile bottom sheet -->
  <div class="sheet" id="sheet" aria-label="Region report bottom sheet">
    <div class="sheetTop">
      <div style="display:flex;align-items:center;gap:10px;min-width:72px;">
        <div class="grab" aria-hidden="true"></div>
      </div>
      <button class="sheetClose" id="sheetClose" type="button">Close</button>
    </div>
    <div class="sheetBody" id="sheetBody"></div>
  </div>

  <footer class="diag" aria-label="Footer diagnostics">
    <div class="left">
      <span>Generated by: ChatGPT (AI model)</span>
      <span class="divider" aria-hidden="true"></span>
      <span style="color: rgba(255,198,105,.72); letter-spacing:.14em;">DIAGNOSTICS</span>
    </div>
    <div class="uptime" id="uptime">Uptime Since Scan Start: 00:00:00</div>
  </footer>

  <script>
    /***********************
     * Seeded daily variation
     ************************/
    function xmur3(str){
      let h = 1779033703 ^ str.length;
      for (let i = 0; i < str.length; i++) {
        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
        h = (h << 13) | (h >>> 19);
      }
      return function() {
        h = Math.imul(h ^ (h >>> 16), 2246822507);
        h = Math.imul(h ^ (h >>> 13), 3266489909);
        return (h ^= (h >>> 16)) >>> 0;
      };
    }
    function mulberry32(a){
      return function(){
        let t = a += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }

    const now = new Date();
    const dayKey = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`;
    const seed = xmur3("geekip-brainscan-"+dayKey)();
    const rnd = mulberry32(seed);

    // Controlled color shift within teal/cyan/violet family
    const hueBase = 178 + Math.round((rnd() - 0.5) * 20); // 168..188
    const hue2 = 188 + Math.round((rnd() - 0.5) * 18);   // 179..197
    const sat = 90;
    const lit = 56 + Math.round((rnd() - 0.5) * 6);
    const signal = `hsl(${hueBase} ${sat}% ${lit}%)`;
    const signal2 = `hsl(${hue2} ${Math.max(78, sat-8)}% ${Math.min(62, lit+2)}%)`;

    const root = document.documentElement;
    root.style.setProperty('--signal', signal);
    root.style.setProperty('--signal2', signal2);
    root.style.setProperty('--signalGlow', 'rgba(90,245,255,.34)');
    root.style.setProperty('--noiseOpacity', (0.18 + rnd() * 0.10).toFixed(2));

    /***********************
     * Data: region cards
     ************************/
    const REGIONS = {
      glgl: {
        title: "GlglStats",
        kicker: "Auditory Cortex • Region Report",
        summary: "Python project measuring repetitiveness of Israeli pop-chart songs using LZ77 compression; visualizes repetition patterns across famous songs.",
        tags: ["Python", "LZ77", "Data Viz"],
        links: [
          {label:"Visit", href:"https://glglstats.geekip.dev", cls:"primary"},
          {label:"PyData TLV Talk (Video)", href:"https://www.youtube.com/watch?v=jrKAtOsj1Lo", cls:"violet"}
        ],
        motif: "wave"
      },
      parking: {
        title: "Ahuzat Dibuk",
        kicker: "Spatial / Navigation • Region Report",
        summary: "Python scraping + data visualization: Tel-Aviv parking lot occupancy statistics and resident-friendly heat-maps.",
        tags: ["Python", "Scraping", "Heat-maps"],
        links: [
          {label:"13tv Story", href:"https://13tv.co.il/item/news/domestic/internal/parking-902956407/", cls:"primary"},
          {label:"mako Story", href:"https://www.mako.co.il/nexter-news/Article-ae43964b891bf71027.htm", cls:"violet"},
          {label:"Original Facebook Post", href:"https://www.facebook.com/groups/secrettelaviv/posts/10159636301195943/", cls:"amber"}
        ],
        motif: "heat"
      },
      orient: {
        title: "2D Part Orienting",
        kicker: "Motor Planning • Region Report",
        summary: "C++ implementation in an open-source computational geometry library: efficient construction of a ‘push plan’ to orient a given polygon.",
        tags: ["C++", "Computational Geometry", "Algorithms"],
        links: [
          {label:"Details & Code", href:"https://www.cgl.cs.tau.ac.il/projects/2d-part-orienting/", cls:"primary"}
        ],
        motif: "poly"
      },
      jest: {
        title: "The Turing Jest",
        kicker: "Language & Humor • Region Report",
        summary: "An LMSYS-like arena where LLMs compete at making and explaining puns; users rate the results.",
        tags: ["LLMs", "Web", "Evaluation Arena"],
        links: [
          {label:"Open Arena", href:"https://jest.geekip.dev", cls:"primary"}
        ],
        motif: "bubble"
      },
      rhymes: {
        title: "Rhymes of Israel",
        kicker: "Creative Rewrite • Region Report",
        summary: "Chrome extension using an LLM to rewrite Israeli news headlines into comedic rhymes, like a high-school yearbook.",
        tags: ["Chrome Extension", "LLM", "NLP"],
        links: [
          {label:"Install Extension", href:"https://chromewebstore.google.com/detail/eainginjgdkpgolpjniijdihfbeeeklb", cls:"primary"}
        ],
        motif: "rhymes"
      },
      meta: {
        title: "Portfolio (Meta)",
        kicker: "Self-Model / Meta • Region Report",
        summary: "A portfolio website project—this very brain-scan interface.",
        tags: ["UI Systems", "Web", "Interaction Design"],
        links: [
          {label:"Self Reference", href:"https://geekip.dev", cls:"primary"}
        ],
        motif: "recursive"
      },
      connect: {
        title: "Connect",
        kicker: "Connectome • Region Report",
        summary: "A clean social hub: code, career, and public presence — connected as a small graph.",
        tags: ["GitHub", "LinkedIn", "Facebook"],
        links: [
          {label:"GitHub", href:"https://github.com/gevak", cls:"primary"},
          {label:"LinkedIn", href:"https://linkedin.com/in/gevakip", cls:"violet"},
          {label:"Facebook", href:"https://facebook.com/geva.kipper", cls:"amber"}
        ],
        motif: "connectome",
        isConnect: true
      }
    };

    /***********************
     * Panel rendering (dock/sheet)
     ************************/
    function esc(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

    function motifMarkup(motif){
      if (motif === "wave"){
        return `
          <svg class="motif motif-wave" viewBox="0 0 320 220" aria-hidden="true">
            <path d="M10 90 C35 60, 55 120, 80 90 S130 120, 160 90 S210 60, 240 90 S285 120, 310 90" />
            <path d="M10 120 C35 90, 55 150, 80 120 S130 150, 160 120 S210 90, 240 120 S285 150, 310 120" opacity=".75"/>
            <path d="M10 150 C35 120, 55 180, 80 150 S130 180, 160 150 S210 120, 240 150 S285 180, 310 150" opacity=".5"/>
          </svg>`;
      }
      if (motif === "heat"){
        return `<div class="heatmap" aria-hidden="true"></div>`;
      }
      if (motif === "poly"){
        return `
          <div class="polyWrap" aria-hidden="true">
            <svg viewBox="0 0 240 240">
              <polygon points="120,30 200,80 182,170 120,208 55,170 40,92"
                fill="none" stroke="rgba(90,245,255,.28)" stroke-width="2"/>
              <polygon points="120,50 176,88 165,155 120,185 70,155 58,98"
                fill="none" stroke="rgba(170,110,255,.22)" stroke-width="2"/>
              <path class="arrowPath" d="M40 190 C70 160, 110 150, 132 128 C152 108, 170 82, 205 64" />
              <path d="M205 64 L190 66 L199 78 Z" fill="rgba(90,245,255,.28)"/>
            </svg>
          </div>`;
      }
      if (motif === "bubble"){
        return `
          <svg class="bubble" viewBox="0 0 200 140" aria-hidden="true">
            <path d="M32 26
                     Q32 14 44 14
                     H156
                     Q168 14 168 26
                     V86
                     Q168 98 156 98
                     H98
                     L76 118
                     L78 98
                     H44
                     Q32 98 32 86
                     Z"
              fill="none" stroke="rgba(90,245,255,.26)" stroke-width="2"/>
            <path d="M60 48 H140" stroke="rgba(170,110,255,.20)" stroke-width="2" stroke-linecap="round"/>
            <path d="M60 66 H120" stroke="rgba(90,245,255,.20)" stroke-width="2" stroke-linecap="round"/>
          </svg>`;
      }
      if (motif === "rhymes"){
        return `<div class="rhymesLines" aria-hidden="true"></div>`;
      }
      if (motif === "recursive"){
        return `
          <div class="recursive" aria-hidden="true">
            <div class="frame"></div>
            <div class="frame"></div>
            <div class="frame"></div>
          </div>`;
      }
      if (motif === "connectome"){
        return `
          <svg class="connectome" viewBox="0 0 240 170" aria-hidden="true">
            <defs>
              <linearGradient id="cgrad" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="rgba(90,245,255,.34)"/>
                <stop offset="1" stop-color="rgba(170,110,255,.26)"/>
              </linearGradient>
            </defs>
            <path id="cpath1" d="M50 40 C90 30, 120 40, 150 66" stroke="url(#cgrad)" stroke-width="2" fill="none" stroke-linecap="round" stroke-dasharray="2 8"/>
            <path id="cpath2" d="M60 120 C95 95, 130 92, 170 70" stroke="url(#cgrad)" stroke-width="2" fill="none" stroke-linecap="round" stroke-dasharray="2 8"/>
            <path id="cpath3" d="M60 120 C92 132, 132 132, 182 120" stroke="rgba(255,198,105,.20)" stroke-width="2" fill="none" stroke-linecap="round" stroke-dasharray="2 8"/>
            <circle cx="50" cy="40" r="6" fill="rgba(90,245,255,.42)"/>
            <circle cx="60" cy="120" r="6" fill="rgba(170,110,255,.34)"/>
            <circle cx="182" cy="120" r="6" fill="rgba(255,198,105,.26)"/>
          </svg>`;
      }
      return "";
    }

    function renderPanelHTML(id, mode /* "preview" | "pinned" */){
      const r = REGIONS[id];
      if (!r) return "";

      const modeCls = (mode === "pinned") ? "isPinned" : "isPreview";
      const linksHtml = (r.isConnect)
        ? "" // custom connect layout below
        : `<div class="actions">${
            r.links.map(l => `<a class="pill ${esc(l.cls||'')}" target="_blank" rel="noreferrer" href="${esc(l.href)}">${esc(l.label)}</a>`).join("")
          }</div>`;

      const connectButtons = r.isConnect ? `
        <div class="connectBtnRow">
          <a class="iconBtn" target="_blank" rel="noreferrer" href="https://github.com/gevak" data-social="github">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="rgba(232,241,244,.85)" d="M12 2a10 10 0 0 0-3.16 19.49c.5.09.68-.22.68-.48v-1.69c-2.77.6-3.35-1.17-3.35-1.17-.45-1.15-1.11-1.46-1.11-1.46-.9-.62.07-.61.07-.61 1 .07 1.52 1.03 1.52 1.03.89 1.52 2.34 1.08 2.91.83.09-.64.35-1.08.63-1.33-2.21-.25-4.54-1.1-4.54-4.9 0-1.08.39-1.96 1.03-2.65-.1-.25-.45-1.27.1-2.64 0 0 .84-.27 2.75 1.02A9.6 9.6 0 0 1 12 6.8c.85 0 1.7.11 2.5.33 1.9-1.29 2.74-1.02 2.74-1.02.55 1.37.2 2.39.1 2.64.64.69 1.03 1.57 1.03 2.65 0 3.81-2.34 4.65-4.57 4.89.36.31.68.92.68 1.85v2.74c0 .26.18.58.69.48A10 10 0 0 0 12 2z"/></svg>
            <div class="iconLabel">GitHub</div>
          </a>
          <a class="iconBtn" target="_blank" rel="noreferrer" href="https://linkedin.com/in/gevakip" data-social="linkedin">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="rgba(232,241,244,.85)" d="M4.98 3.5A2.5 2.5 0 0 1 7.5 6a2.5 2.5 0 0 1-2.52 2.5A2.5 2.5 0 0 1 2.5 6 2.5 2.5 0 0 1 4.98 3.5zM3 9h4v12H3V9zm7 0h3.8v1.64h.05c.53-1 1.83-2.05 3.76-2.05 4.02 0 4.77 2.65 4.77 6.09V21h-4v-5.41c0-1.29-.02-2.95-1.8-2.95-1.8 0-2.08 1.4-2.08 2.86V21h-4V9z"/></svg>
            <div class="iconLabel">LinkedIn</div>
          </a>
          <a class="iconBtn" target="_blank" rel="noreferrer" href="https://facebook.com/geva.kipper" data-social="facebook">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="rgba(232,241,244,.85)" d="M22 12a10 10 0 1 0-11.56 9.87v-6.99H7.9V12h2.54V9.8c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.23.2 2.23.2v2.46h-1.26c-1.24 0-1.62.77-1.62 1.56V12h2.76l-.44 2.88h-2.32v6.99A10 10 0 0 0 22 12z"/></svg>
            <div class="iconLabel">Facebook</div>
          </a>
        </div>
        <div class="actions" style="margin-top:12px">
          <a class="pill primary" target="_blank" rel="noreferrer" href="https://github.com/gevak">github.com/gevak</a>
          <a class="pill violet" target="_blank" rel="noreferrer" href="https://linkedin.com/in/gevakip">linkedin.com/in/gevakip</a>
          <a class="pill amber" target="_blank" rel="noreferrer" href="https://facebook.com/geva.kipper">facebook.com/geva.kipper</a>
        </div>
      ` : "";

      const tags = `<div class="tags">${r.tags.map(t => `<span class="tag">${esc(t)}</span>`).join("")}</div>`;

      // Notice text differs between preview/pinned
      const hint = (mode === "pinned")
        ? `<div class="panelNotice">Pinned selection. Hover other regions to preview; click a new region to pin it. <span class="kbd">Esc</span> clears.</div>`
        : `<div class="panelNotice">Hover to preview. Click to pin and expand actions.</div>`;

      return `
        <div class="${modeCls}">
          <div class="panelCard">
            ${motifMarkup(r.motif)}
            <div class="panelMeta">
              <div>
                <h2 class="panelTitle">${esc(r.title)}</h2>
                <div class="panelKicker">${esc(r.kicker)}</div>
              </div>
              <div style="text-align:right; min-width: 120px;">
                <div class="panelKicker" style="color: rgba(255,198,105,.70);">Signal</div>
                <div style="font-family:var(--mono); font-size:12px; letter-spacing:.08em; color: rgba(232,241,244,.72);">
                  ${(0.62 + rnd()*0.30).toFixed(2)} kHz
                </div>
              </div>
            </div>

            <p class="panelSummary">${esc(r.summary)}</p>

            ${tags}

            ${r.isConnect ? connectButtons : (mode === "pinned" ? linksHtml : "")}

            ${r.motif === "bubble" ? (mode === "pinned" ? `<div class="rating" aria-hidden="true"></div>` : ``) : ``}
          </div>

          ${hint}
        </div>
      `;
    }

    /***********************
     * Interaction: regions -> dock + synapse
     ************************/
    const svg = document.getElementById('brain');
    const regionsG = document.getElementById('regions');
    const hintCircle = document.getElementById('regionHint');
    const synapsePath = document.getElementById('synapsePath');
    const contours = document.getElementById('brainContours');

    const dockPanel = document.getElementById('dockPanel');
    const sheet = document.getElementById('sheet');
    const sheetBody = document.getElementById('sheetBody');
    const sheetClose = document.getElementById('sheetClose');

    let hoveredId = null;
    let pinnedId = "meta"; // default center
    let pointerInMap = false;
    let lastNearest = null;

    function isMobile(){
      return window.matchMedia("(max-width: 820px)").matches;
    }

    function clearRegionsActive(){
      [...regionsG.querySelectorAll('.region')].forEach(el => el.classList.remove('active'));
    }

    function setRegionsDim(dim){
      if (dim) regionsG.classList.add('regionsDim');
      else regionsG.classList.remove('regionsDim');
    }

    function setActiveRegion(id){
      clearRegionsActive();
      const el = regionsG.querySelector(`.region[data-id="${id}"]`);
      if (el) el.classList.add('active');
    }

    function getRegionCenter(el){
      // Use the dot as a stable anchor
      const dot = el.querySelector('.dot');
      const cx = parseFloat(dot.getAttribute('cx'));
      const cy = parseFloat(dot.getAttribute('cy'));
      return {cx, cy};
    }

    function mapPointToViewport(x, y){
      const pt = svg.createSVGPoint();
      pt.x = x; pt.y = y;
      const screen = pt.matrixTransform(svg.getScreenCTM());
      return {x: screen.x, y: screen.y};
    }

    function computeSynapsePath(fromCx, fromCy){
      // Target: dock (desktop) or bottom sheet (mobile)
      const from = mapPointToViewport(fromCx, fromCy);

      let to;
      if (!isMobile()){
        const dockRect = document.querySelector('aside.dock')?.getBoundingClientRect();
        to = { x: dockRect.left + 18, y: dockRect.top + Math.min(220, dockRect.height * 0.32) };
      } else {
        const sheetRect = sheet.getBoundingClientRect();
        const y = sheet.classList.contains('open') ? (sheetRect.top + 30) : (window.innerHeight - (parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--footerH')) || 44) - 26);
        to = { x: window.innerWidth * 0.62, y };
      }

      // Convert viewport target back into SVG coords
      const inv = svg.getScreenCTM().inverse();
      const pt = svg.createSVGPoint();
      pt.x = to.x; pt.y = to.y;
      const toSvg = pt.matrixTransform(inv);

      const dx = (toSvg.x - fromCx);
      const c1 = { x: fromCx + dx * 0.35, y: fromCy - 50 };
      const c2 = { x: fromCx + dx * 0.70, y: toSvg.y + 30 };

      return `M ${fromCx} ${fromCy} C ${c1.x} ${c1.y} ${c2.x} ${c2.y} ${toSvg.x} ${toSvg.y}`;
    }

    function animateSynapse(fromEl){
      if (!fromEl) return;
      const {cx, cy} = getRegionCenter(fromEl);
      const d = computeSynapsePath(cx, cy);
      synapsePath.setAttribute('d', d);
      synapsePath.style.opacity = "1";

      // restart dash animation
      const len = synapsePath.getTotalLength();
      synapsePath.style.transition = "none";
      synapsePath.style.strokeDasharray = "7 7";
      synapsePath.style.strokeDashoffset = String(len);
      // force reflow
      synapsePath.getBoundingClientRect();
      synapsePath.style.transition = "stroke-dashoffset .55s ease, opacity .18s ease";
      synapsePath.style.strokeDashoffset = "0";
    }

    function hideSynapse(){
      synapsePath.style.opacity = "0";
    }

    function showPanel(id, mode){
      const html = renderPanelHTML(id, mode);
      if (!isMobile()){
        dockPanel.innerHTML = html;
      } else {
        sheetBody.innerHTML = html;
        if (mode === "pinned"){
          sheet.classList.add('open');
        }
      }
    }

    function setHover(id){
      hoveredId = id;
      const el = regionsG.querySelector(`.region[data-id="${id}"]`);
      if (!el) return;

      // Dim others unless nothing pinned? keep pinned dimming on hover too.
      setRegionsDim(true);
      setActiveRegion(pinnedId);

      // preview in dock/sheet
      if (id !== pinnedId){
        showPanel(id, "preview");
      } else {
        showPanel(id, "pinned");
      }

      animateSynapse(el);
    }

    function setPinned(id){
      pinnedId = id;
      setActiveRegion(id);
      setRegionsDim(true);
      showPanel(id, "pinned");

      const el = regionsG.querySelector(`.region[data-id="${id}"]`);
      animateSynapse(el);
    }

    // Default panel
    setPinned(pinnedId);

    // Daily subtle region rebalancing (jitter)
    (function applyDailyJitter(){
      const regions = [...regionsG.querySelectorAll('.region')];
      const magnitude = 8 + Math.round(rnd()*8); // 8..16 px
      regions.forEach((g, i) => {
        const jx = Math.round((rnd() - .5) * magnitude);
        const jy = Math.round((rnd() - .5) * magnitude);
        // apply to dot, hit, label
        g.querySelectorAll('circle, text').forEach(node => {
          const tag = node.tagName.toLowerCase();
          if (tag === 'text') {
            node.setAttribute('x', (parseFloat(node.getAttribute('x')) + jx).toString());
            node.setAttribute('y', (parseFloat(node.getAttribute('y')) + jy).toString());
          } else {
            const cx = parseFloat(node.getAttribute('cx'));
            const cy = parseFloat(node.getAttribute('cy'));
            if (!Number.isNaN(cx) && !Number.isNaN(cy)) {
              node.setAttribute('cx', (cx + jx).toString());
              node.setAttribute('cy', (cy + jy).toString());
            }
          }
        });
      });
    })();

    // Pointer interactions
    function onRegionEnter(e){
      const g = e.currentTarget;
      setHover(g.dataset.id);
    }
    function onRegionLeave(){
      hoveredId = null;
      hideSynapse();
      // return to pinned panel
      showPanel(pinnedId, "pinned");
      setActiveRegion(pinnedId);
      setRegionsDim(true);
    }
    function onRegionClick(e){
      const g = e.currentTarget;
      setPinned(g.dataset.id);
      if (isMobile()) sheet.classList.add('open');
    }
    function onRegionKey(e){
      if (e.key === "Enter" || e.key === " "){
        e.preventDefault();
        setPinned(e.currentTarget.dataset.id);
        if (isMobile()) sheet.classList.add('open');
      }
    }

    [...regionsG.querySelectorAll('.region')].forEach(g => {
      g.addEventListener('pointerenter', onRegionEnter);
      g.addEventListener('pointerleave', onRegionLeave);
      g.addEventListener('click', onRegionClick);
      g.addEventListener('keydown', onRegionKey);
    });

    // Mobile sheet close
    sheetClose.addEventListener('click', () => sheet.classList.remove('open'));

    // ESC clears pin (returns to meta)
    window.addEventListener('keydown', (e) => {
      if (e.key === "Escape"){
        sheet.classList.remove('open');
        setPinned("meta");
      }
    });

    // Ring highlight near cursor + micro-parallax
    const mapEl = document.querySelector('.map');
    mapEl.addEventListener('pointerenter', () => { pointerInMap = true; });
    mapEl.addEventListener('pointerleave', () => {
      pointerInMap = false;
      hintCircle.style.opacity = "0";
      contours.style.transform = "translate(0px, 0px)";
    });

    function nearestRegionToSvgPoint(x, y){
      const regs = [...regionsG.querySelectorAll('.region')];
      let best = null;
      let bestD = Infinity;
      for (const r of regs){
        const {cx, cy} = getRegionCenter(r);
        const dx = cx - x;
        const dy = cy - y;
        const d = Math.hypot(dx, dy);
        if (d < bestD){ bestD = d; best = r; }
      }
      return {best, bestD};
    }

    mapEl.addEventListener('pointermove', (ev) => {
      if (!pointerInMap) return;

      // micro-parallax on contours
      const rect = mapEl.getBoundingClientRect();
      const nx = (ev.clientX - (rect.left + rect.width/2)) / rect.width;
      const ny = (ev.clientY - (rect.top + rect.height/2)) / rect.height;
      const tx = Math.max(-1, Math.min(1, nx)) * 8;
      const ty = Math.max(-1, Math.min(1, ny)) * 7;
      contours.style.transform = `translate(${tx}px, ${ty}px)`;

      // ring highlight: find nearest region in SVG coords
      const inv = svg.getScreenCTM().inverse();
      const pt = svg.createSVGPoint();
      pt.x = ev.clientX; pt.y = ev.clientY;
      const p = pt.matrixTransform(inv);

      const {best, bestD} = nearestRegionToSvgPoint(p.x, p.y);
      const threshold = 62;
      if (best && bestD < threshold){
        const {cx, cy} = getRegionCenter(best);
        hintCircle.setAttribute('cx', cx);
        hintCircle.setAttribute('cy', cy);
        hintCircle.setAttribute('r', (18 + (1 - bestD/threshold) * 10).toFixed(1));
        hintCircle.style.opacity = String(0.25 + (1 - bestD/threshold) * 0.55);

        if (lastNearest !== best){
          lastNearest = best;
        }
      } else {
        hintCircle.style.opacity = "0";
        lastNearest = null;
      }
    });

    // Keep synapse target updated on resize (dock/sheet changes)
    window.addEventListener('resize', () => {
      const el = regionsG.querySelector(`.region[data-id="${hoveredId || pinnedId}"]`);
      if (el) animateSynapse(el);
    });
    window.addEventListener('scroll', () => {
      const el = regionsG.querySelector(`.region[data-id="${hoveredId || pinnedId}"]`);
      if (el) animateSynapse(el);
    }, {passive:true});

    /***********************
     * EEG strip animation (aesthetic; reacts to scroll + hover intensity)
     ************************/
    const eeg = document.getElementById('eeg');
    const eegCtx = eeg.getContext('2d');
    function resizeEEG(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      const rect = eeg.getBoundingClientRect();
      eeg.width = Math.round(rect.width * dpr);
      eeg.height = Math.round(rect.height * dpr);
      eegCtx.setTransform(dpr,0,0,dpr,0,0);
    }
    resizeEEG();
    window.addEventListener('resize', resizeEEG);

    let eegT = 0;
    let scrollV = 0;
    let lastScrollY = window.scrollY;

    window.addEventListener('scroll', () => {
      const y = window.scrollY;
      scrollV = (y - lastScrollY);
      lastScrollY = y;
    }, {passive:true});

    function drawEEG(){
      const w = eeg.getBoundingClientRect().width;
      const h = eeg.getBoundingClientRect().height;
      eegCtx.clearRect(0,0,w,h);

      // baseline grid
      eegCtx.globalAlpha = 1;
      eegCtx.strokeStyle = "rgba(255,255,255,.07)";
      eegCtx.lineWidth = 1;
      eegCtx.beginPath();
      for (let x=0; x<=w; x+=28){
        eegCtx.moveTo(x, 0);
        eegCtx.lineTo(x, h);
      }
      eegCtx.stroke();

      // waveform
      const amp = 3.5 + Math.min(10, Math.abs(scrollV)*0.18) + (pointerInMap ? 5.2 : 0.0);
      const base = h * 0.52;

      // gradient stroke
      const grad = eegCtx.createLinearGradient(0,0,w,0);
      grad.addColorStop(0, "rgba(90,245,255,.25)");
      grad.addColorStop(0.5, "rgba(90,245,255,.65)");
      grad.addColorStop(1, "rgba(170,110,255,.32)");

      eegCtx.strokeStyle = grad;
      eegCtx.lineWidth = 2;
      eegCtx.beginPath();
      for (let x=0; x<=w; x++){
        const t = eegT + x * 0.018;
        const y = base
          + Math.sin(t) * amp
          + Math.sin(t*2.2 + 1.3) * (amp*0.35)
          + Math.sin(t*0.52 + 2.0) * (amp*0.55);
        if (x === 0) eegCtx.moveTo(x, y);
        else eegCtx.lineTo(x, y);
      }
      eegCtx.stroke();

      // mild decay of scroll velocity
      scrollV *= 0.90;
      eegT += 0.06;
      requestAnimationFrame(drawEEG);
    }
    requestAnimationFrame(drawEEG);

    /***********************
     * Noise canvas (subtle, animated)
     ************************/
    const noiseCanvas = document.getElementById('noise');
    const nctx = noiseCanvas.getContext('2d', { alpha: true });
    let nW=0, nH=0, nImg=null;
    function resizeNoise(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      nW = Math.floor(innerWidth * dpr);
      nH = Math.floor(innerHeight * dpr);
      noiseCanvas.width = nW;
      noiseCanvas.height = nH;
      noiseCanvas.style.width = innerWidth + "px";
      noiseCanvas.style.height = innerHeight + "px";
      nImg = nctx.createImageData(nW, nH);
    }
    resizeNoise();
    window.addEventListener('resize', resizeNoise);

    // Daily noise "pattern change": use seeded RNG with some time drift
    let noiseTick = 0;
    function paintNoise(){
      if (!nImg) return;
      const data = nImg.data;
      // keep it light: sample every few pixels
      const stride = 4;
      const t = noiseTick++;
      for (let i=0; i<data.length; i+=4*stride){
        const v = (rnd() * 255) | 0;
        data[i] = v;
        data[i+1] = v;
        data[i+2] = v;
        data[i+3] = 22 + ((v + t) % 28); // alpha
      }
      nctx.putImageData(nImg, 0, 0);
    }
    // ~12fps
    setInterval(paintNoise, 84);

    /***********************
     * Footer uptime stopwatch
     * hours:minutes:seconds since 2025-12-25 01:10:39 (local time)
     ************************/
    const start = new Date(2025, 11, 25, 1, 10, 39); // month is 0-based
    const uptimeEl = document.getElementById('uptime');

    function pad2(n){ return String(n).padStart(2,'0'); }
    function updateUptime(){
      const diff = Math.max(0, Date.now() - start.getTime());
      const totalSec = Math.floor(diff/1000);
      const hh = Math.floor(totalSec/3600);
      const mm = Math.floor((totalSec%3600)/60);
      const ss = totalSec%60;
      uptimeEl.textContent = `Uptime Since Scan Start: ${pad2(hh)}:${pad2(mm)}:${pad2(ss)}`;
    }
    updateUptime();
    setInterval(updateUptime, 1000);

    /***********************
     * Gentle "AI daily redesign" polish:
     * small global brain shift + contour hue drift (already set)
     ************************/
    const shiftX = Math.round((rnd() - 0.5) * 8);
    const shiftY = Math.round((rnd() - 0.5) * 6);
    root.style.setProperty('--brainShiftX', shiftX + "px");
    root.style.setProperty('--brainShiftY', shiftY + "px");

    // Keep map selection sensible on first paint
    setActiveRegion(pinnedId);
    setRegionsDim(true);

    // If user taps the map background on mobile, close sheet
    mapEl.addEventListener('click', (e) => {
      if (!isMobile()) return;
      if (e.target.closest('.region')) return;
      sheet.classList.remove('open');
    });

  </script>
<!-- Add this block to embed the like button -->
    <script src="/static/js/like_button.js"></script>
    <script>
        LikeButton.init({
          pageId: "20251225",
          position: "bottom-right", // Options: bottom-right, bottom-left, top-right, top-left
        });
    </script>

</body>
</html>