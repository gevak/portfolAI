<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GEVA KIPPER ‚Äî Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

::-webkit-scrollbar {
  width: 6px;
}
::-webkit-scrollbar-track {
  background: #000;
}
::-webkit-scrollbar-thumb {
  background: #00FF41;
  box-shadow: 0 0 8px #00FF41;
  border-radius: 0;
}

html {
  scrollbar-color: #00FF41 #000;
  scrollbar-width: thin;
}

body {
  background: #000;
  color: #00FF41;
  font-family: 'Fira Code', monospace;
  overflow-x: hidden;
  min-height: 100vh;
}

#matrix-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
  pointer-events: none;
}

#overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #000;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: opacity 1s ease;
}

#overlay.fade-out {
  opacity: 0;
  pointer-events: none;
}

#assembly-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 999;
  pointer-events: none;
}

#content {
  position: relative;
  z-index: 1;
  opacity: 0;
  transition: opacity 0.8s ease;
  max-width: 1200px;
  margin: 0 auto;
  padding: 40px 20px 80px;
}

#content.visible {
  opacity: 1;
}

.header {
  text-align: center;
  margin-bottom: 60px;
  padding-top: 40px;
}

.header-name {
  font-size: 4rem;
  font-weight: 700;
  letter-spacing: 0.15em;
  color: #00FF41;
  text-shadow: 0 0 20px rgba(0,255,65,0.5), 0 -20px 40px rgba(0,255,65,0.15);
  position: relative;
  display: inline-block;
}

.header-name .char {
  display: inline-block;
  position: relative;
}

.header-name .char::before {
  content: '';
  position: absolute;
  top: -30px;
  left: 50%;
  width: 1px;
  height: 25px;
  background: linear-gradient(to bottom, transparent, rgba(0,255,65,0.4));
  transform: translateX(-50%);
}

.header-role {
  font-size: 1rem;
  color: #4A7A5A;
  margin-top: 10px;
  animation: pulse-opacity 3s ease-in-out infinite;
}

.header-role::after {
  content: '‚ñà';
  animation: blink-cursor 1s step-end infinite;
  margin-left: 4px;
}

@keyframes pulse-opacity {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

@keyframes blink-cursor {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

.header-line {
  width: 0;
  height: 1px;
  background: #00FF41;
  margin: 20px auto;
  box-shadow: 0 0 8px rgba(0,255,65,0.5);
  animation: draw-line 2s ease forwards;
  animation-delay: 4s;
}

@keyframes draw-line {
  to { width: 300px; }
}

.header-subtitle {
  font-size: 0.85rem;
  color: #80FF80;
  font-style: italic;
  margin-top: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.infinity-symbol {
  display: inline-block;
  animation: rotate-infinity 6s linear infinite;
  font-size: 1.2rem;
}

@keyframes rotate-infinity {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
  margin-top: 40px;
}

@media (max-width: 1024px) {
  .grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 640px) {
  .grid {
    grid-template-columns: 1fr;
  }
  .header-name {
    font-size: 2.2rem;
  }
}

.card {
  background: #050505;
  border: 1px solid #1A3A1A;
  padding: 24px;
  position: relative;
  overflow: hidden;
  transition: all 0.3s ease;
  transform: translateY(0);
  opacity: 0;
  transform: translateY(20px);
}

.card.visible {
  opacity: 1;
  transform: translateY(0);
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0,255,65,0.02) 2px,
    rgba(0,255,65,0.02) 4px
  );
  pointer-events: none;
  z-index: 1;
}

.card > * {
  position: relative;
  z-index: 2;
}

.card:hover {
  border-color: #00FF41;
  box-shadow: 0 0 15px rgba(0,255,65,0.3);
  transform: translateY(-4px);
}

.card.meta-card {
  border: 2px solid #1A3A1A;
}

.card.meta-card:hover {
  border-color: #00FF41;
}

.card-rain-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  pointer-events: none;
  z-index: 0;
  opacity: 0;
  transition: opacity 0.5s ease;
}

.card:hover .card-rain-overlay {
  opacity: 1;
}

.card-rain-char {
  position: absolute;
  color: rgba(0,255,65,0.1);
  font-size: 10px;
  animation: card-rain-fall linear infinite;
}

@keyframes card-rain-fall {
  0% { transform: translateY(-20px); opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% { transform: translateY(300px); opacity: 0; }
}

.card-title {
  font-size: 1.3rem;
  font-weight: 600;
  color: #00FF41;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.card-title .icon {
  font-size: 1.1rem;
}

.card-desc {
  font-size: 0.8rem;
  color: #4A7A5A;
  line-height: 1.6;
  margin-bottom: 16px;
}

.card-link {
  display: inline-block;
  color: #00FF41;
  text-decoration: underline;
  font-size: 0.8rem;
  transition: color 0.2s, text-shadow 0.2s;
  cursor: pointer;
  margin-top: 6px;
}

.card-link:hover {
  color: #7DFDAA;
  text-shadow: 0 0 8px rgba(0,255,65,0.5);
}

.card-link .arrow {
  animation: blink-cursor 1.5s step-end infinite;
}

.terminal-links {
  list-style: none;
  font-size: 0.8rem;
}

.terminal-links li {
  margin: 6px 0;
  position: relative;
  overflow: hidden;
}

.terminal-links a {
  color: #00FF41;
  text-decoration: none;
  transition: color 0.2s, text-shadow 0.2s;
  display: inline-block;
  position: relative;
}

.terminal-links a::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(0,255,65,0.15), transparent);
  transition: left 0.4s ease;
}

.terminal-links a:hover {
  color: #7DFDAA;
  text-shadow: 0 0 8px rgba(0,255,65,0.5);
}

.terminal-links a:hover::after {
  left: 100%;
}

.video-thumb {
  background: #0a0a0a;
  border: 1px solid #1A3A1A;
  padding: 20px;
  text-align: center;
  margin: 12px 0;
  cursor: pointer;
  transition: border-color 0.3s, box-shadow 0.3s;
}

.video-thumb:hover {
  border-color: #00FF41;
  box-shadow: 0 0 10px rgba(0,255,65,0.2);
}

.play-icon {
  font-size: 2rem;
  color: #00FF41;
}

.video-label {
  font-size: 0.7rem;
  color: #4A7A5A;
  margin-top: 6px;
}

.rotating-polygon {
  display: inline-block;
  animation: slow-rotate 8s linear infinite;
}

@keyframes slow-rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.pun-battle {
  font-size: 0.7rem;
  color: #4A7A5A;
  margin-top: 12px;
  min-height: 3em;
  border-top: 1px solid #1A3A1A;
  padding-top: 8px;
}

.pun-line {
  margin: 4px 0;
  transition: opacity 0.5s;
}

.headline-demo {
  font-size: 0.7rem;
  color: #4A7A5A;
  margin-top: 12px;
  min-height: 2.5em;
  border-top: 1px solid #1A3A1A;
  padding-top: 8px;
}

.social-card {
  text-align: center;
}

.social-card .card-title {
  justify-content: center;
  font-size: 1rem;
  color: #4A7A5A;
}

.social-btn {
  display: block;
  margin: 12px auto;
  padding: 10px 30px;
  border: 1px solid #1A3A1A;
  color: #00FF41;
  text-decoration: none;
  font-family: 'Fira Code', monospace;
  font-size: 0.9rem;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
  max-width: 240px;
  background: transparent;
}

.social-btn::before {
  content: attr(data-label);
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #050505;
  color: #00FF41;
  opacity: 0;
  transition: opacity 0.15s;
}

.social-btn:hover {
  border-color: #00FF41;
  box-shadow: 0 0 15px rgba(0,255,65,0.3);
  text-shadow: 0 0 8px rgba(0,255,65,0.5);
}

.social-btn:hover::before {
  animation: glitch-btn 0.4s steps(1) forwards;
}

@keyframes glitch-btn {
  0% { opacity: 1; content: '„Ç¢ „Ç´ „Çµ „Çø'; }
  20% { opacity: 1; content: '‚ñà ‚ñë ‚ñì ‚ñà ‚ñë'; }
  40% { opacity: 1; content: '„Éû „É§ „É© „ÉØ'; }
  60% { opacity: 0; }
  100% { opacity: 0; }
}

.footer {
  text-align: center;
  margin-top: 80px;
  position: relative;
  z-index: 1;
}

.footer-line {
  width: 0;
  height: 1px;
  background: #00FF41;
  margin: 0 auto 20px;
  box-shadow: 0 0 8px rgba(0,255,65,0.3);
}

.footer-line.animate {
  animation: draw-footer-line 1.5s ease forwards;
}

@keyframes draw-footer-line {
  to { width: 80%; }
}

.footer-credit {
  font-size: 0.7rem;
  color: #1A3A1A;
}

.stopwatch {
  font-size: 1.1rem;
  color: #00FF41;
  margin-top: 16px;
  text-shadow: 0 0 10px rgba(0,255,65,0.4);
  letter-spacing: 0.1em;
  padding-bottom: 40px;
}

.stopwatch .digit {
  display: inline-block;
  min-width: 0.7em;
  text-align: center;
  transition: text-shadow 0.1s;
}

.stopwatch .digit.tick {
  text-shadow: 0 0 20px rgba(0,255,65,0.8);
}

.shimmer-text {
  display: inline;
}

/* Card entry rain animation */
.card-entry-rain {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 10;
  pointer-events: none;
  overflow: hidden;
}

.card-entry-char {
  position: absolute;
  color: #00FF41;
  font-size: 12px;
  font-family: 'Fira Code', monospace;
  transition: all 1s ease;
}
</style>
</head>
<body>

<canvas id="matrix-canvas"></canvas>
<div id="overlay"></div>
<canvas id="assembly-canvas"></canvas>

<div id="content">
  <header class="header">
    <h1 class="header-name" id="header-name"></h1>
    <p class="header-role">Software Engineer at Google</p>
    <div class="header-line"></div>
    <p class="header-subtitle">
      <span id="subtitle-text">Redesigned daily by AI ‚Äî an ever-changing artifact</span>
      <span class="infinity-symbol">‚àû</span>
    </p>
  </header>

  <div class="grid" id="card-grid">
    <!-- Card 1: GlglStats -->
    <div class="card" data-card="0">
      <div class="card-rain-overlay" id="rain-0"></div>
      <div class="card-title"><span class="icon">‚ô™</span> GlglStats</div>
      <div class="card-desc">A Python project measuring repetitiveness of Israeli pop-chart songs using LZ77 compression, visualizing repetition patterns of famous songs across decades.</div>
      <a href="https://www.youtube.com/watch?v=jrKAtOsj1Lo" target="_blank" rel="noopener" class="video-thumb">
        <div class="play-icon">‚ñ∂</div>
        <div class="video-label">PyData TLV Talk</div>
      </a>
      <a href="https://glglstats.geekip.dev" target="_blank" rel="noopener" class="card-link"><span class="arrow">‚Üí</span> Explore GlglStats</a>
    </div>

    <!-- Card 2: Ahuzat Dibuk -->
    <div class="card" data-card="1">
      <div class="card-rain-overlay" id="rain-1"></div>
      <div class="card-title"><span class="icon">üÖø</span> Ahuzat Dibuk</div>
      <div class="card-desc">A Python scraping and data visualization project collecting Tel-Aviv parking lot occupancy statistics and generating heatmaps for residents.</div>
      <ul class="terminal-links">
        <li><a href="https://13tv.co.il/item/news/domestic/internal/parking-902956407/" target="_blank" rel="noopener">&gt; Channel 13 News Coverage</a></li>
        <li><a href="https://www.mako.co.il/nexter-news/Article-ae43964b891bf71027.htm" target="_blank" rel="noopener">&gt; Mako News Coverage</a></li>
        <li><a href="https://www.facebook.com/groups/secrettelaviv/posts/10159636301195943" target="_blank" rel="noopener">&gt; Original Post (Facebook)</a></li>
      </ul>
    </div>

    <!-- Card 3: 2D Part Orienting -->
    <div class="card" data-card="2">
      <div class="card-rain-overlay" id="rain-2"></div>
      <div class="card-title">
        <span class="icon rotating-polygon">
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="#00FF41" stroke-width="1.5">
            <polygon points="10,1 18,7 15,18 5,18 2,7"/>
          </svg>
        </span>
        2D Part Orienting
      </div>
      <div class="card-desc">A C++ implementation in an open-source computational geometry library of an efficient algorithm for constructing a push plan to orient a given polygon.</div>
      <a href="https://www.cgl.cs.tau.ac.il/projects/2d-part-orienting/" target="_blank" rel="noopener" class="card-link"><span class="arrow">‚Üí</span> Project & Code</a>
    </div>

    <!-- Card 4: The Turing Jest -->
    <div class="card" data-card="3">
      <div class="card-rain-overlay" id="rain-3"></div>
      <div class="card-title"><span class="icon">üòÇ</span> The Turing Jest</div>
      <div class="card-desc">An LMSYS-style arena where LLMs compete at making and explaining puns, with answers rated by users in head-to-head matchups.</div>
      <a href="https://jest.geekip.dev" target="_blank" rel="noopener" class="card-link"><span class="arrow">‚Üí</span> Enter the Arena</a>
      <div class="pun-battle" id="pun-battle">
        <div class="pun-line" id="pun-a"></div>
        <div class="pun-line" id="pun-b"></div>
      </div>
    </div>

    <!-- Card 5: Rhymes of Israel -->
    <div class="card" data-card="4">
      <div class="card-rain-overlay" id="rain-4"></div>
      <div class="card-title">
        <span class="icon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#00FF41" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <circle cx="12" cy="12" r="4"/>
            <line x1="21.17" y1="8" x2="15.87" y2="8"/>
            <line x1="8.13" y1="8" x2="2.83" y2="8"/>
            <line x1="21.17" y1="16" x2="15.87" y2="16"/>
            <line x1="8.13" y1="16" x2="2.83" y2="16"/>
          </svg>
        </span>
        Rhymes of Israel
      </div>
      <div class="card-desc">A Chrome extension that uses an LLM to rewrite Israeli news headlines into comedic rhymes in the style of a high school yearbook.</div>
      <a href="https://chromewebstore.google.com/detail/eainginjgdkpgolpjniijdihfbeeeklb" target="_blank" rel="noopener" class="card-link"><span class="arrow">‚Üí</span> Install Extension</a>
      <div class="headline-demo" id="headline-demo"></div>
    </div>

    <!-- Card 6: geekip.dev (Meta) -->
    <div class="card meta-card" data-card="5" id="meta-card">
      <div class="card-rain-overlay" id="rain-5"></div>
      <div class="card-title"><span class="icon">ü™û</span> geekip.dev</div>
      <div class="card-desc">You're looking at it. This portfolio site is redesigned daily by AI ‚Äî an ever-changing digital artifact, never the same twice.</div>
      <a href="#" class="card-link" id="meta-link"><span class="arrow">‚Üí</span> You are here</a>
    </div>

    <!-- Card 7: Social Links -->
    <div class="card social-card" data-card="6">
      <div class="card-rain-overlay" id="rain-6"></div>
      <div class="card-title">///</div>
      <a href="https://github.com/gevak" target="_blank" rel="noopener" class="social-btn" data-label="GitHub">[ GitHub ]</a>
      <a href="https://linkedin.com/in/gevakip" target="_blank" rel="noopener" class="social-btn" data-label="LinkedIn">[ LinkedIn ]</a>
      <a href="https://facebook.com/geva.kipper" target="_blank" rel="noopener" class="social-btn" data-label="Facebook">[ Facebook ]</a>
    </div>
  </div>

  <footer class="footer">
    <div class="footer-line" id="footer-line"></div>
    <div class="footer-credit">Designed by Claude (Anthropic) ¬∑ <span id="current-date"></span></div>
    <div class="stopwatch" id="stopwatch"></div>
  </footer>
</div>

<script>
// ==================== MATRIX CHARACTERS ====================
const matrixChars = '„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
function randomChar() {
  return matrixChars[Math.floor(Math.random() * matrixChars.length)];
}

// ==================== BACKGROUND MATRIX RAIN ====================
const canvas = document.getElementById('matrix-canvas');
const ctx = canvas.getContext('2d');
let columns, drops;
let matrixFontSize = 14;
const isMobile = window.innerWidth < 640;

function initCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  columns = Math.floor(canvas.width / matrixFontSize);
  if (isMobile) columns = Math.floor(columns * 0.5);
  drops = new Array(columns).fill(1);
}
initCanvas();
window.addEventListener('resize', initCanvas);

let bgRainOpacity = 0;
let bgRainTargetOpacity = 0.25;

function drawMatrixRain() {
  ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  
  ctx.fillStyle = `rgba(0, 255, 65, ${bgRainOpacity})`;
  ctx.font = matrixFontSize + 'px Fira Code, monospace';
  
  for (let i = 0; i < drops.length; i++) {
    const text = randomChar();
    ctx.fillText(text, i * matrixFontSize, drops[i] * matrixFontSize);
    
    if (drops[i] * matrixFontSize > canvas.height && Math.random() > 0.975) {
      drops[i] = 0;
    }
    drops[i]++;
  }
}

let matrixInterval;
function startBackgroundRain() {
  matrixInterval = setInterval(drawMatrixRain, 33); // ~30fps
}

// ==================== OPENING SEQUENCE ====================
const overlay = document.getElementById('overlay');
const assemblyCanvas = document.getElementById('assembly-canvas');
const actx = assemblyCanvas.getContext('2d');
assemblyCanvas.width = window.innerWidth;
assemblyCanvas.height = window.innerHeight;

// Phase 1: Full-screen intense rain
let openingDrops = [];
let openingColumns = Math.floor(window.innerWidth / 14);
for (let i = 0; i < openingColumns; i++) {
  openingDrops.push({
    x: i * 14,
    y: Math.random() * -500,
    speed: 4 + Math.random() * 8,
    chars: []
  });
}

let openingPhase = 0; // 0 = rain, 1 = assembling, 2 = done
let openingStart = Date.now();
const openingDuration = isMobile ? 2000 : 3000;
const assemblyDuration = 1500;

// Target text to assemble
const targetName = "GEVA KIPPER";
let targetChars = [];

function calculateTargetPositions() {
  const fontSize = Math.min(window.innerWidth / 8, 64);
  actx.font = `700 ${fontSize}px Fira Code, monospace`;
  const metrics = actx.measureText(targetName);
  const startX = (window.innerWidth - metrics.width) / 2;
  const startY = window.innerHeight / 2;
  
  targetChars = [];
  let xOffset = 0;
  for (let i = 0; i < targetName.length; i++) {
    const charMetrics = actx.measureText(targetName[i]);
    targetChars.push({
      char: targetName[i],
      targetX: startX + xOffset,
      targetY: startY,
      currentX: Math.random() * window.innerWidth,
      currentY: -50 - Math.random() * 500,
      currentChar: randomChar(),
      settled: false,
      fontSize: fontSize
    });
    xOffset += charMetrics.width;
  }
}

calculateTargetPositions();

function drawOpeningRain() {
  actx.fillStyle = 'rgba(0, 0, 0, 0.1)';
  actx.fillRect(0, 0, assemblyCanvas.width, assemblyCanvas.height);
  
  actx.font = '14px Fira Code, monospace';
  actx.fillStyle = '#00FF41';
  
  for (let drop of openingDrops) {
    const ch = randomChar();
    actx.fillText(ch, drop.x, drop.y);
    drop.y += drop.speed;
    if (drop.y > assemblyCanvas.height) {
      drop.y = Math.random() * -100;
    }
  }
}

function drawAssembly(progress) {
  actx.clearRect(0, 0, assemblyCanvas.width, assemblyCanvas.height);
  
  // Draw remaining rain chars dimming out
  actx.font = '14px Fira Code, monospace';
  actx.fillStyle = `rgba(0, 255, 65, ${0.3 * (1 - progress)})`;
  for (let drop of openingDrops) {
    actx.fillText(randomChar(), drop.x, drop.y);
    drop.y += drop.speed * (1 - progress * 0.8);
    drop.x += (Math.random() - 0.5) * progress * 4;
  }
  
  // Draw assembling characters
  for (let tc of targetChars) {
    const eased = easeOutCubic(Math.min(progress * 1.2, 1));
    tc.currentX += (tc.targetX - tc.currentX) * eased * 0.15;
    tc.currentY += (tc.targetY - tc.currentY) * eased * 0.15;
    
    const dist = Math.hypot(tc.currentX - tc.targetX, tc.currentY - tc.targetY);
    
    if (dist < 5) {
      tc.currentChar = tc.char;
      tc.settled = true;
    } else if (Math.random() > 0.7) {
      tc.currentChar = randomChar();
    }
    
    actx.font = `700 ${tc.fontSize}px Fira Code, monospace`;
    actx.fillStyle = tc.settled ? '#00FF41' : `rgba(0, 255, 65, ${0.5 + progress * 0.5})`;
    if (tc.settled) {
      actx.shadowColor = '#00FF41';
      actx.shadowBlur = 20;
    }
    actx.fillText(tc.currentChar, tc.currentX, tc.currentY);
    actx.shadowBlur = 0;
  }
}

function easeOutCubic(t) {
  return 1 - Math.pow(1 - t, 3);
}

let openingAnimId;
function animateOpening() {
  const elapsed = Date.now() - openingStart;
  
  if (openingPhase === 0) {
    drawOpeningRain();
    if (elapsed > openingDuration) {
      openingPhase = 1;
      openingStart = Date.now();
    }
  } else if (openingPhase === 1) {
    const progress = Math.min((Date.now() - openingStart) / assemblyDuration, 1);
    drawAssembly(progress);
    if (progress >= 1) {
      openingPhase = 2;
      openingStart = Date.now();
    }
  } else if (openingPhase === 2) {
    // Hold for a moment then fade
    const holdTime = Date.now() - openingStart;
    if (holdTime > 800) {
      assemblyCanvas.style.transition = 'opacity 1s ease';
      assemblyCanvas.style.opacity = '0';
      overlay.classList.add('fade-out');
      document.getElementById('content').classList.add('visible');
      bgRainOpacity = bgRainTargetOpacity;
      startBackgroundRain();
      startShimmer();
      startSubtitleAnimation();
      startPunBattle();
      startHeadlineDemo();
      initCardObserver();
      setTimeout(() => {
        assemblyCanvas.remove();
        overlay.remove();
      }, 1200);
      return;
    }
    drawAssembly(1);
  }
  
  openingAnimId = requestAnimationFrame(animateOpening);
}

animateOpening();

// ==================== HEADER NAME WITH GLOW TRAILS ====================
const headerNameEl = document.getElementById('header-name');
const nameText = "GEVA KIPPER";
nameText.split('').forEach(ch => {
  const span = document.createElement('span');
  span.className = 'char shimmer-text';
  span.textContent = ch;
  span.dataset.original = ch;
  headerNameEl.appendChild(span);
});

// ==================== TEXT SHIMMER EFFECT ====================
function startShimmer() {
  setInterval(() => {
    const shimmerEls = document.querySelectorAll('.shimmer-text');
    shimmerEls.forEach(el => {
      if (Math.random() < 0.015) {
        const orig = el.dataset.original;
        el.textContent = randomChar();
        setTimeout(() => {
          el.textContent = orig;
        }, 80);
      }
    });
  }, 100);
}

// ==================== SUBTITLE DISSOLVE/REASSEMBLE ====================
const subtitleEl = document.getElementById('subtitle-text');
const subtitleOriginal = subtitleEl.textContent;

function startSubtitleAnimation() {
  setInterval(() => {
    dissolveAndReassemble(subtitleEl, subtitleOriginal);
  }, 20000);
}

function dissolveAndReassemble(el, text) {
  let chars = text.split('');
  let indices = chars.map((_, i) => i);
  
  // Shuffle indices for dissolve order
  for (let i = indices.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [indices[i], indices[j]] = [indices[j], indices[i]];
  }
  
  let dissolved = [...chars];
  let step = 0;
  
  // Dissolve
  const dissolveInterval = setInterval(() => {
    if (step < indices.length) {
      dissolved[indices[step]] = randomChar();
      el.textContent = dissolved.join('');
      step++;
    } else {
      clearInterval(dissolveInterval);
      
      // Reassemble
      let rstep = 0;
      const reassembleInterval = setInterval(() => {
        if (rstep < indices.length) {
          dissolved[indices[rstep]] = chars[indices[rstep]];
          el.textContent = dissolved.join('');
          rstep++;
        } else {
          clearInterval(reassembleInterval);
        }
      }, 30);
    }
  }, 30);
}

// ==================== CARD ENTRY ANIMATIONS ====================
function initCardObserver() {
  const cards = document.querySelectorAll('.card');
  
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting && !entry.target.classList.contains('visible')) {
        animateCardEntry(entry.target);
      }
    });
  }, { threshold: 0.2 });
  
  cards.forEach(card => observer.observe(card));
}

function animateCardEntry(card) {
  const rainOverlay = document.createElement('div');
  rainOverlay.className = 'card-entry-rain';
  card.appendChild(rainOverlay);
  
  // Hide real content briefly
  const children = Array.from(card.children).filter(c => !c.classList.contains('card-entry-rain') && !c.classList.contains('card-rain-overlay'));
  children.forEach(c => c.style.opacity = '0');
  
  // Create mini rain chars
  const rect = card.getBoundingClientRect();
  const numChars = Math.floor((rect.width * rect.height) / 400);
  const chars = [];
  
  for (let i = 0; i < numChars; i++) {
    const span = document.createElement('span');
    span.className = 'card-entry-char';
    span.textContent = randomChar();
    span.style.left = Math.random() * 100 + '%';
    span.style.top = -20 - Math.random() * 100 + 'px';
    span.style.opacity = '0.8';
    rainOverlay.appendChild(span);
    chars.push(span);
  }
  
  // Animate rain fall
  let startTime = Date.now();
  function animateRain() {
    const elapsed = Date.now() - startTime;
    const progress = Math.min(elapsed / 600, 1);
    
    chars.forEach((span, i) => {
      const targetY = (i / numChars) * rect.height * 0.8 + 10;
      const currentY = -20 + (targetY + 20) * easeOutCubic(progress);
      span.style.top = currentY + 'px';
      
      if (Math.random() > 0.7) {
        span.textContent = randomChar();
      }
    });
    
    if (progress < 1) {
      requestAnimationFrame(animateRain);
    } else {
      // Fade out rain, show content
      rainOverlay.style.transition = 'opacity 0.5s';
      rainOverlay.style.opacity = '0';
      children.forEach(c => {
        c.style.transition = 'opacity 0.5s';
        c.style.opacity = '1';
      });
      card.classList.add('visible');
      
      setTimeout(() => rainOverlay.remove(), 600);
    }
  }
  
  requestAnimationFrame(animateRain);
  
  // Also make card visible via CSS
  setTimeout(() => card.classList.add('visible'), 50);
}

// ==================== CARD HOVER RAIN ====================
document.querySelectorAll('.card').forEach((card, index) => {
  const rainOverlay = card.querySelector('.card-rain-overlay') || document.getElementById('rain-' + index);
  if (!rainOverlay) return;
  
  // Pre-populate rain chars
  for (let i = 0; i < 15; i++) {
    const span = document.createElement('span');
    span.className = 'card-rain-char';
    span.textContent = randomChar();
    span.style.left = Math.random() * 100 + '%';
    span.style.animationDuration = (2 + Math.random() * 3) + 's';
    span.style.animationDelay = Math.random() * 2 + 's';
    rainOverlay.appendChild(span);
  }
  
  // Refresh rain chars periodically
  setInterval(() => {
    rainOverlay.querySelectorAll('.card-rain-char').forEach(span => {
      span.textContent = randomChar();
    });
  }, 500);
});

// ==================== PUN BATTLE ANIMATION ====================
const puns = [
  { a: "LLM-1: I'm reading a book on anti-gravity ‚Äî it's impossible to put down!", b: "LLM-2: I used to hate math, but then I realized decimals have a point. ‚≠ê" },
  { a: "LLM-1: Why do programmers prefer dark mode? Less bugs. ‚≠ê", b: "LLM-2: Parallel lines have so much in common ‚Äî shame they'll never meet." },
  { a: "LLM-1: I told my compiler a joke. It didn't C the humor.", b: "LLM-2: I'd tell you a UDP joke but you might not get it. ‚≠ê" }
];

let punIndex = 0;
function startPunBattle() {
  const punA = document.getElementById('pun-a');
  const punB = document.getElementById('pun-b');
  
  function showPun() {
    const pun = puns[punIndex % puns.length];
    punA.style.opacity = '0';
    punB.style.opacity = '0';
    
    setTimeout(() => {
      punA.textContent = pun.a;
      punA.style.opacity = '1';
    }, 300);
    
    setTimeout(() => {
      punB.textContent = pun.b;
      punB.style.opacity = '1';
    }, 800);
    
    punIndex++;
  }
  
  showPun();
  setInterval(showPun, 5000);
}

// ==================== HEADLINE DEMO ANIMATION ====================
const headlines = [
  { before: "Traffic jam on Highway 1", after: "‚ô™ Cars in a line, what a sign, stuck on One, no fun ‚ô™" },
  { before: "New caf√© opens in Florentin", after: "‚ô™ Florentin's got a brand new bean, the hippest caf√© ever seen ‚ô™" },
  { before: "Humidity breaks new record", after: "‚ô™ The air is thick, the sweat is quick, humidity's mean trick ‚ô™" }
];

let headlineIndex = 0;
function startHeadlineDemo() {
  const el = document.getElementById('headline-demo');
  
  function showHeadline() {
    const hl = headlines[headlineIndex % headlines.length];
    el.textContent = hl.before;
    
    setTimeout(() => {
      // Dissolve to random chars
      let text = hl.before.split('');
      let step = 0;
      const dissolve = setInterval(() => {
        if (step < text.length) {
          text[step] = randomChar();
          el.textContent = text.join('');
          step++;
        } else {
          clearInterval(dissolve);
          
          // Reassemble into rhyme
          let rhyme = hl.after.split('');
          let rebuilt = new Array(rhyme.length).fill(null).map(() => randomChar());
          el.textContent = rebuilt.join('');
          
          let rstep = 0;
          const reassemble = setInterval(() => {
            if (rstep < rhyme.length) {
              rebuilt[rstep] = rhyme[rstep];
              el.textContent = rebuilt.join('');
              rstep++;
            } else {
              clearInterval(reassemble);
            }
          }, 25);
        }
      }, 25);
    }, 1500);
    
    headlineIndex++;
  }
  
  showHeadline();
  setInterval(showHeadline, 6000);
}

// ==================== META CARD CLICK ‚Äî FULL PAGE RAIN RESET ====================
document.getElementById('meta-link').addEventListener('click', (e) => {
  e.preventDefault();
  
  const content = document.getElementById('content');
  content.style.transition = 'opacity 0.8s';
  content.style.opacity = '0';
  
  // Temporarily boost rain
  bgRainOpacity = 0.8;
  
  setTimeout(() => {
    bgRainOpacity = bgRainTargetOpacity;
    content.style.opacity = '1';
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }, 2000);
});

// ==================== STOPWATCH ====================
const stopwatchEl = document.getElementById('stopwatch');
const startDate = new Date('2026-02-06T01:25:00Z');

function updateStopwatch() {
  const now = new Date();
  let diff = Math.max(0, Math.floor((now - startDate) / 1000));
  
  const days = Math.floor(diff / 86400);
  diff %= 86400;
  const hours = Math.floor(diff / 3600);
  diff %= 3600;
  const minutes = Math.floor(diff / 60);
  const seconds = diff % 60;
  
  const daysStr = String(days).padStart(5, '0');
  const hoursStr = String(hours).padStart(2, '0');
  const minutesStr = String(minutes).padStart(2, '0');
  const secondsStr = String(seconds).padStart(2, '0');
  
  const timeStr = `${daysStr}:${hoursStr}:${minutesStr}:${secondsStr}`;
  
  let html = '';
  for (let i = 0; i < timeStr.length; i++) {
    const ch = timeStr[i];
    if (ch === ':') {
      html += '<span class="digit">:</span>';
    } else {
      // On second change, briefly show random chars
      html += `<span class="digit">${ch}</span>`;
    }
  }
  
  stopwatchEl.innerHTML = html;
}

// Add digit flicker effect on each second
let lastSecond = -1;
function updateStopwatchWithFlicker() {
  const now = new Date();
  const currentSecond = now.getSeconds();
  
  if (currentSecond !== lastSecond) {
    lastSecond = currentSecond;
    
    // Show random chars briefly
    const digits = stopwatchEl.querySelectorAll('.digit');
    digits.forEach(d => {
      if (d.textContent !== ':' && Math.random() > 0.5) {
        const orig = d.textContent;
        d.textContent = Math.floor(Math.random() * 10).toString();
        d.classList.add('tick');
        setTimeout(() => {
          d.classList.remove('tick');
        }, 200);
      }
    });
    
    setTimeout(updateStopwatch, 120);
  }
  
  requestAnimationFrame(updateStopwatchWithFlicker);
}

updateStopwatch();
requestAnimationFrame(updateStopwatchWithFlicker);
setInterval(updateStopwatch, 1000);

// ==================== FOOTER LINE ANIMATION ====================
const footerLine = document.getElementById('footer-line');
const footerObserver = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('animate');
    }
  });
}, { threshold: 0.5 });
footerObserver.observe(footerLine);

// ==================== CURRENT DATE ====================
document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});

// ==================== PARALLAX EFFECT ====================
let scrollY = 0;
window.addEventListener('scroll', () => {
  scrollY = window.scrollY;
  canvas.style.transform = `translateY(${scrollY * 0.15}px)`;
}, { passive: true });
</script>

<!-- Add this block to embed the like button -->
    <script src="/static/js/like_button.js"></script>
    <script>
        LikeButton.init({
          pageId: "20260206",
          position: "bottom-right", // Options: bottom-right, bottom-left, top-right, top-left
        });
    </script>

</body>
</html>