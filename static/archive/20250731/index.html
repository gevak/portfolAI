<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geva Kipper - The Geva Kipper Metro</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Fira+Code&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <style>
        :root {
            --bg-color: #1A1A1A;
            --text-color: #FFFFFF;
            --header-font: 'Montserrat', sans-serif;
            --monospace-font: 'Fira Code', monospace;
            --panel-bg: rgba(20, 20, 20, 0.85);

            --line-python: #FF8C00; /* Vibrant Orange */
            --line-ai: #00FFFF; /* Electric Blue / Cyan */
            --line-cpp: #32CD32; /* Emerald Green */
            --line-webdev: #FF00FF; /* Magenta */
            --line-connect: #808080; /* Cool Grey */
        }

        /* --- Base & Layout --- */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--header-font);
        }

        body {
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            position: relative;
        }

        .map-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: grab;
        }
        .map-container.zooming {
             cursor: default;
        }

        .map-dimmer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
        }
        .map-dimmer.is-active {
            opacity: 0.6;
            pointer-events: auto;
        }

        /* --- Header --- */
        .site-header {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 100;
            pointer-events: none;
        }

        .site-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-color);
        }

        .site-header .role {
            font-size: 1.2rem;
            font-weight: 400;
            margin: 5px 0 10px;
        }

        .site-header .ai-subtitle {
            font-family: var(--monospace-font);
            font-size: 0.9rem;
            color: var(--line-ai);
            animation: pulse-glow 2s infinite ease-in-out;
        }

        .ai-subtitle .cursor {
            display: inline-block;
            width: 10px;
            height: 1em;
            background-color: var(--line-ai);
            margin-left: 5px;
            animation: blink 1s steps(1) infinite;
            vertical-align: text-bottom;
        }

        @keyframes pulse-glow {
            0%, 100% { text-shadow: 0 0 5px var(--line-ai), 0 0 10px var(--line-ai); }
            50% { text-shadow: 0 0 10px var(--line-ai), 0 0 20px var(--line-ai); }
        }

        @keyframes blink {
            50% { opacity: 0; }
        }
        
        /* --- Footer --- */
        .site-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: linear-gradient(to top, rgba(0,0,0,0.5), transparent);
            font-size: 0.8rem;
            color: #aaa;
            z-index: 100;
            pointer-events: none;
        }

        .site-footer .stopwatch {
            font-family: var(--monospace-font);
        }

        /* --- Interactive Map SVG --- */
        .metro-line {
            fill: none;
            stroke-width: 6px;
            stroke-linejoin: round;
            stroke-linecap: round;
        }
        
        .station-group {
            cursor: pointer;
            transition: transform 0.2s ease-out;
        }

        .station-circle {
           stroke: var(--bg-color);
           stroke-width: 4px;
           transition: r 0.2s ease-out;
        }
        
        .station-group:hover .station-circle {
            r: 15;
            animation: pulse-station 1.5s infinite;
        }
        
        @keyframes pulse-station {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }


        .station-interchange {
            r: 14;
            stroke-width: 5px;
            stroke: white;
        }

        .station-terminus {
            stroke: white;
            stroke-width: 4px;
        }

        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 5px 10px;
            color: white;
            font-size: 0.9rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 200;
        }

        /* --- Details Panel --- */
        .details-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 40%;
            height: 100vh;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transform: translateX(100%);
            transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);
            z-index: 150;
            padding: 40px;
            box-sizing: border-box;
            overflow-y: auto;
            color: var(--text-color);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
        }

        .details-panel.is-open {
            transform: translateX(0);
        }

        .panel-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            color: #aaa;
            cursor: pointer;
            transition: color 0.2s, transform 0.2s;
            line-height: 1;
        }
        .panel-close-btn:hover {
            color: white;
            transform: rotate(90deg);
        }

        .panel-content {
            flex-grow: 1;
        }

        .panel-content h2 {
            font-size: 2.2rem;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .panel-content p {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #ddd;
        }
        
        .panel-content .media-embed {
            width: 100%;
            aspect-ratio: 16 / 9;
            border: none;
            border-radius: 8px;
            margin: 20px 0;
        }

        .panel-links {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .panel-links a.button, .panel-links a.icon-button {
            display: block;
            padding: 15px 20px;
            background-color: rgba(255, 255, 255, 0.1);
            text-align: center;
            text-decoration: none;
            color: var(--text-color);
            border-radius: 5px;
            transition: background-color 0.3s, transform 0.2s;
            font-weight: 700;
        }

        .panel-links a.button:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .panel-links .icon-button-group {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .panel-links a.icon-button {
            background-color: transparent;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.2);
        }
         .panel-links a.icon-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .panel-links a.icon-button svg {
            width: 40px;
            height: 40px;
            fill: white;
        }
        
        /* Media Queries for smaller screens */
        @media (max-width: 1024px) {
            .details-panel {
                width: 60%;
            }
             .site-header h1 { font-size: 2rem; }
             .site-header .role { font-size: 1rem; }
        }

        @media (max-width: 768px) {
            .details-panel {
                width: 95%;
            }
            .site-header {
                padding: 0 10px;
            }
            .site-header h1 { font-size: 1.5rem; }
            .site-header .role { font-size: 0.9rem; }
            .ai-subtitle { font-size: 0.8rem; }
            .site-footer { flex-direction: column; text-align: center; gap: 5px; padding: 5px; }

        }

    </style>
</head>
<body>

    <header class="site-header">
        <h1>Geva Kipper</h1>
        <p class="role">Solving complex problems with code at Google.</p>
        <p class="ai-subtitle">This site is programmatically re-designed each day by AI. Layout is ever-changing.<span class="cursor"></span></p>
    </header>

    <main class="map-container" id="map-container">
        <div class="map-dimmer" id="map-dimmer"></div>
        <svg id="metro-map-svg" width="100%" height="100%"></svg>
    </main>
    
    <div class="tooltip" id="tooltip"></div>

    <aside class="details-panel" id="details-panel">
        <div class="panel-close-btn" id="panel-close-btn">&times;</div>
        <div class="panel-content" id="panel-content">
            <!-- Content will be injected here by JavaScript -->
        </div>
    </aside>

    <footer class="site-footer">
        <div class="llm-credit">Site design generated by a large language model.</div>
        <div class="stopwatch">Time since last manual update: <span id="stopwatch-timer"></span></div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DATA ---
        const metroData = {
            stations: [
                { id: 'glglstats', name: 'GlglStats', lines: ['python', 'ai'], content: {
                    title: 'GlglStats',
                    description: 'A Python project that measures the repetitiveness of Israeli pop-chart songs using LZ77 compression, featuring interactive visualizations of lyrical patterns.',
                    media: '<iframe class="media-embed" src="https://www.youtube.com/embed/jrKAtOsj1Lo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>',
                    links: [
                        { label: 'Explore the Data', url: 'https://glglstats.geekip.dev' }
                    ]
                }},
                { id: 'ahuzat', name: 'Ahuzat Dibuk', lines: ['python'], content: {
                    title: 'Ahuzat Dibuk',
                    description: 'A data scraping and visualization project that collects real-time occupancy statistics for Tel-Aviv parking lots, generating predictive heat-maps for residents.',
                    links: [
                        { label: 'Channel 13 News Story', url: 'https://13tv.co.il/item/news/domestic/internal/parking-902956407/' },
                        { label: 'Mako News Coverage', url: 'https://www.mako.co.il/nexter-news/Article-ae43964b891bf71027.htm' },
                        { label: 'Original Facebook Publication', url: 'https://www.facebook.com/groups/secrettelaviv/posts/10159636301195943' }
                    ]
                }},
                { id: 'orienting', name: '2D Part Orienting', lines: ['cpp'], content: {
                    title: '2D Part Orienting',
                    description: 'An efficient C++ algorithm implementation for constructing a \'push plan\' to orient any given polygon, contributed to an open-source computational geometry library.',
                    links: [
                        { label: 'View Code & Research', url: 'https://www.cgl.cs.tau.ac.il/projects/2d-part-orienting/' }
                    ]
                }},
                { id: 'jest', name: 'The Turing Jest', lines: ['ai'], content: {
                    title: 'The Turing Jest',
                    description: 'An LMSYS-style arena where large language models compete to generate and explain puns. User votes determine the wittiest AI.',
                    links: [
                        { label: 'Visit the Arena', url: 'https://jest.geekip.dev' }
                    ]
                }},
                { id: 'rhymes', name: 'Rhymes of Israel', lines: ['ai'], content: {
                    title: 'Rhymes of Israel',
                    description: 'A Chrome extension that uses an LLM to humorously rewrite Israeli news headlines into rhyming couplets, in the style of a high-school yearbook.',
                    links: [
                        { label: 'Install The Extension', url: 'https://chromewebstore.google.com/detail/eainginjgdkpgolpjniijdihfbeeeklb' }
                    ]
                }},
                { id: 'portfolio', name: 'geekip.dev (This Site)', lines: ['webdev'], content: {
                    title: 'The Ever-Changing Portfolio',
                    description: 'You\'re looking at it. This interactive portfolio is a single-page application built with modern web technologies and designed around the concept of a subway map.',
                    links: [
                        { label: 'Reload a New Layout', url: 'https://geekip.dev' }
                    ]
                }},
                { id: 'connect', name: 'Connect', lines: ['connect'], content: {
                    title: 'Get In Touch',
                    description: 'Connect with me on the following platforms.',
                    links: [
                        { type: 'icon', label: 'GitHub', url: 'https://github.com/gevak', icon: '<svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>' },
                        { type: 'icon', label: 'LinkedIn', url: 'https://linkedin.com/in/gevakip', icon: '<svg viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg>' },
                        { type: 'icon', label: 'Facebook', url: 'https://facebook.com/geva.kipper', icon: '<svg viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z"></path></svg>' }
                    ]
                }},
            ],
            lines: {
                python: { name: 'Python Line', color: 'var(--line-python)', stationIds: ['ahuzat', 'glglstats'] },
                ai: { name: 'AI/LLM Line', color: 'var(--line-ai)', stationIds: ['rhymes', 'glglstats', 'jest'] },
                cpp: { name: 'C++ Systems Line', color: 'var(--line-cpp)', stationIds: ['orienting'] },
                webdev: { name: 'WebDev Line', color: 'var(--line-webdev)', stationIds: ['portfolio', 'portfolio'] }, // Loop
                connect: { name: 'Connect Line', color: 'var(--line-connect)', stationIds: ['connect'] },
            }
        };

        // --- ELEMENTS ---
        const mapContainer = d3.select("#map-container");
        const svg = d3.select("#metro-map-svg");
        const tooltip = d3.select("#tooltip");
        const detailsPanel = d3.select("#details-panel");
        const panelContent = d3.select("#panel-content");
        const panelCloseBtn = d3.select("#panel-close-btn");
        const mapDimmer = d3.select("#map-dimmer");
        const g = svg.append("g");
        
        // --- LAYOUT GENERATION (seeded by date) ---
        function seededRandom(seed) {
            let state = seed % 2147483647;
            if (state <= 0) state += 2147483646;
            return () => {
                state = state * 16807 % 2147483647;
                return (state - 1) / 2147483646;
            };
        }

        const date = new Date();
        const dateSeedString = `${date.getFullYear()}${date.getMonth()}${date.getDate()}`;
        const seed = parseInt(dateSeedString.split('').reduce((acc, char) => acc + char.charCodeAt(0), ''));
        const random = seededRandom(seed);
        
        const { width, height } = mapContainer.node().getBoundingClientRect();
        const padding = 150; // Padding from screen edges
        
        metroData.stations.forEach(station => {
            station.x = padding + random() * (width - 2 * padding);
            station.y = padding + random() * (height - 2 * padding);
        });

        // --- MAP DRAWING ---
        const stationMap = new Map(metroData.stations.map(s => [s.id, s]));

        const lineGenerator = d3.line()
            .x(d => d.x)
            .y(d => d.y)
            .curve(d3.curveCatmullRom.alpha(0.5));

        // Draw Lines
        g.selectAll('.metro-line')
            .data(Object.values(metroData.lines))
            .enter()
            .append('path')
            .attr('class', 'metro-line')
            .attr('d', d => lineGenerator(d.stationIds.map(id => stationMap.get(id))))
            .style('stroke', d => d.color)
            .style('filter', d => `drop-shadow(0 0 8px ${d.color})`);
            
        // Draw Stations
        const stationGroups = g.selectAll('.station-group')
            .data(metroData.stations)
            .enter()
            .append('g')
            .attr('class', 'station-group')
            .attr('transform', d => `translate(${d.x}, ${d.y})`)
            .on('click', (event, d) => handleStationClick(event, d))
            .on('mouseover', (event, d) => handleStationMouseover(event, d))
            .on('mouseout', handleStationMouseout);
            
        stationGroups.append('circle')
            .attr('class', 'station-circle')
            .attr('r', 10)
            .style('fill', d => {
                const firstLine = metroData.lines[d.lines[0]];
                return firstLine ? firstLine.color : 'white';
            })
            .each(function(d) {
                // Add specific classes for styling
                if (d.lines.length > 1) d3.select(this).classed('station-interchange', true);
                if (d.id === 'connect') d3.select(this).classed('station-terminus', true);
            });
            
        // --- INTERACTIVITY & PANEL LOGIC ---
        const zoom = d3.zoom()
            .scaleExtent([0.5, 8])
            .on('zoom', (event) => {
                g.attr('transform', event.transform);
            });
            
        svg.call(zoom);
        
        // Center the initial view
        const initialTransform = d3.zoomIdentity
            .translate(width / 2, height / 2)
            .scale(0.8)
            .translate(-width / 2, -height / 2);
        svg.call(zoom.transform, initialTransform);
        
        function handleStationClick(event, d) {
            event.stopPropagation();
            if (detailsPanel.classed('is-open')) {
                closePanel();
            }
            
            const scale = 2;
            const x = width / 2 - d.x * scale;
            const y = height / 2 - d.y * scale;
            const transform = d3.zoomIdentity.translate(x, y).scale(scale);

            svg.transition()
                .duration(750)
                .call(zoom.transform, transform);
            
            openPanel(d);
        }

        function handleStationMouseover(event, d) {
            tooltip.style('opacity', 1)
                   .html(d.name)
                   .style('left', (event.pageX + 15) + 'px')
                   .style('top', (event.pageY - 15) + 'px');
        }

        function handleStationMouseout() {
            tooltip.style('opacity', 0);
        }

        function openPanel(stationData) {
            mapDimmer.classed('is-active', true);
            detailsPanel.classed('is-open', true);
            mapContainer.classed('zooming', true);

            const { title, description, media, links } = stationData.content;
            let linksHtml = '';
            
            const iconLinks = links.filter(l => l.type === 'icon');
            const buttonLinks = links.filter(l => l.type !== 'icon');
            
            if (buttonLinks.length > 0) {
                 linksHtml += buttonLinks.map(link => 
                    `<a href="${link.url}" target="_blank" class="button">${link.label}</a>`
                ).join('');
            }
            
            if (iconLinks.length > 0) {
                 linksHtml += `<div class="icon-button-group">` + iconLinks.map(link => 
                    `<a href="${link.url}" target="_blank" class="icon-button" aria-label="${link.label}">${link.icon}</a>`
                ).join('') + `</div>`;
            }

            panelContent.html(`
                <h2>${title}</h2>
                <p>${description}</p>
                ${media ? media : ''}
                <div class="panel-links">${linksHtml}</div>
            `);
        }

        function closePanel() {
            detailsPanel.classed('is-open', false);
            mapDimmer.classed('is-active', false);
            mapContainer.classed('zooming', false);

            svg.transition()
                .duration(750)
                .call(zoom.transform, initialTransform);
        }

        panelCloseBtn.on('click', closePanel);
        mapDimmer.on('click', closePanel);
        
        // --- FOOTER STOPWATCH ---
        const stopwatchTimer = document.getElementById('stopwatch-timer');
        const startTime = new Date('2025-07-31T01:14:39Z').getTime();

        function updateStopwatch() {
            const now = new Date().getTime();
            const diff = now - startTime;

            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            stopwatchTimer.textContent = 
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        setInterval(updateStopwatch, 1000);
        updateStopwatch();
    });
    </script>

<!-- Add this block to embed the like button -->
    <script src="/static/js/like_button.js"></script>
    <script>
        LikeButton.init({
          pageId: "20250731",
          position: "bottom-right", // Options: bottom-right, bottom-left, top-right, top-left
        });
    </script>

</body>
</html>