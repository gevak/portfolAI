<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geva Kipper | Engineering Portfolio</title>
    <!-- Load Three.js from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;700&family=VT323&display=swap" rel="stylesheet">

    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-primary: #1a1a2e;
            --highlight: #00bcd4;
            --solar-green: #9CCC65;
            --led-red: #ff3333;
        }

        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Space Grotesk', sans-serif;
            background-color: #2b2b2b; /* Fallback */
            color: var(--text-primary);
        }

        /* 3D Canvas */
        #canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }

        /* HUD Overlay Layer */
        #hud {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none; /* Let clicks pass through to 3D except on interactive elements */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Glassmorphism Common */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 15px 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            pointer-events: auto;
        }

        /* Top Left Bio */
        .bio-section h1 {
            margin: 0;
            font-size: 1.8rem;
            font-weight: 700;
        }
        .bio-section p {
            margin: 5px 0 0;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Top Right Glitch */
        .glitch-container {
            text-align: right;
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            color: #333;
        }
        .glitch-text {
            animation: pulse-glitch 3s infinite;
        }

        /* Bottom Left Tutorial */
        .controls-hint {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.8rem;
        }
        .key {
            border: 1px solid rgba(0,0,0,0.3);
            border-radius: 4px;
            padding: 2px 6px;
            background: rgba(255,255,255,0.3);
            font-weight: bold;
        }

        /* Interaction Prompt (Floating) */
        #interact-prompt {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            display: none;
            z-index: 20;
            animation: bounce 1s infinite alternate;
        }

        /* Project Modal Overlay */
        #project-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.4);
            z-index: 100;
            display: none;
            justify-content: center;
            align-items: center;
            pointer-events: auto;
        }
        
        .modal-content {
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 16px;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease-out;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: bold;
            color: #555;
        }

        .modal-close:hover { color: #000; }

        .project-tag {
            display: inline-block;
            background: #eee;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-bottom: 15px;
            color: #555;
            font-weight: bold;
            text-transform: uppercase;
        }

        .btn {
            display: inline-block;
            background: var(--text-primary);
            color: #fff;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 6px;
            margin-top: 20px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        .btn:hover { transform: scale(1.05); }

        /* Footer Bar */
        #footer-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #111;
            color: #888;
            font-size: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 20px;
            box-sizing: border-box;
            z-index: 50;
            border-top: 1px solid #333;
        }
        .singularity-timer {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            color: var(--led-red);
            letter-spacing: 1px;
        }

        /* Animations */
        @keyframes pulse-glitch {
            0% { opacity: 1; transform: skewX(0deg); }
            5% { opacity: 0.8; transform: skewX(20deg); }
            10% { opacity: 1; transform: skewX(-5deg); }
            100% { opacity: 1; transform: skewX(0deg); }
        }
        @keyframes bounce {
            from { transform: translate(-50%, -50%); }
            to { transform: translate(-50%, -60%); }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Embed Utilities */
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 */
            height: 0;
            margin: 15px 0;
        }
        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }
        .floating-icons a {
            font-size: 2rem;
            margin-right: 15px;
            text-decoration: none;
        }
    </style>
</head>
<body>

    <!-- 3D Scene Container -->
    <div id="canvas-container"></div>

    <!-- HUD Overlay -->
    <div id="hud">
        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
            <!-- Bio -->
            <div class="glass-panel bio-section">
                <h1>Geva Kipper</h1>
                <p>Currently engineering at Google.</p>
            </div>
            
            <!-- Glitch Subtitle -->
            <div class="glass-panel glitch-container">
                <span class="glitch-text">This digital architecture is re-imagined daily by AI.<br>Current iteration: v.2024.X</span>
            </div>
        </div>

        <!-- Controls Hint -->
        <div class="glass-panel" style="align-self: flex-start; margin-bottom: 25px;">
            <div class="controls-hint">
                <span class="key">W</span><span class="key">A</span><span class="key">S</span><span class="key">D</span>
                <span>to Move</span>
                <span style="margin-left:10px;">‚Ä¢</span>
                <span style="margin-left:10px;">Click Stations to Interact</span>
            </div>
        </div>
    </div>

    <!-- Interaction Prompt -->
    <div id="interact-prompt">Press SPACE to Inspect</div>

    <!-- Modal System -->
    <div id="project-modal">
        <div class="modal-content" id="modal-inner">
            <span class="modal-close" onclick="closeModal()">√ó</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Fixed Footer -->
    <div id="footer-bar">
        <div>Site architecture generated by AI Model [DeepSeek-V3]</div>
        <div class="singularity-timer" id="singularity-timer">Calculating Singularity...</div>
    </div>

    <script>
        // --- 1. CONFIGURATION & STATE ---
        const config = {
            colors: {
                floor: 0xf5f5f5,
                wall: 0xe0e0e0,
                accent: 0x4fc3f7,
                highlight: 0xffeb3b,
                dark: 0x333333,
                plantGreen: 0x66bb6a,
                plantPot: 0x8d6e63
            },
            speed: 0.15,
            interactionDist: 4
        };

        const state = {
            canMove: true,
            activeStation: null,
            targetPosition: null
        };

        // --- 2. THREE.JS SETUP ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xdceefb); // Soft pastel blue sky
        scene.fog = new THREE.Fog(0xdceefb, 20, 50);

        // Isometric Camera setup
        const aspect = window.innerWidth / window.innerHeight;
        const d = 20;
        const camera = new THREE.OrthographicCamera(-d * aspect, d * aspect, d, -d, 1, 1000);
        camera.position.set(20, 20, 20); // Isometric angle
        camera.lookAt(scene.position);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        container.appendChild(renderer.domElement);

        // Lighting
        const hemiLight = new THREE.HemisphereLight(0xffffff, 0xffffff, 0.6);
        scene.add(hemiLight);

        const dirLight = new THREE.DirectionalLight(0xffffff, 0.7);
        dirLight.position.set(10, 20, 10);
        dirLight.castShadow = true;
        dirLight.shadow.mapSize.width = 2048;
        dirLight.shadow.mapSize.height = 2048;
        dirLight.shadow.camera.left = -30;
        dirLight.shadow.camera.right = 30;
        dirLight.shadow.camera.top = 30;
        dirLight.shadow.camera.bottom = -30;
        scene.add(dirLight);

        // --- 3. ENVIRONMENT GENERATION ---

        // Materials
        const mats = {
            floor: new THREE.MeshStandardMaterial({ color: config.colors.floor }),
            skin: new THREE.MeshStandardMaterial({ color: 0xffccaa }),
            hoodie: new THREE.MeshStandardMaterial({ color: 0x333333 }),
            pants: new THREE.MeshStandardMaterial({ color: 0x555555 }),
            furniture: new THREE.MeshStandardMaterial({ color: 0xffffff }),
            wood: new THREE.MeshStandardMaterial({ color: 0x8d6e63 }),
            highlight: new THREE.MeshStandardMaterial({ color: config.colors.highlight, emissive: 0xffee58, emissiveIntensity: 0.2 }),
            hologram: new THREE.MeshPhongMaterial({ color: 0x00ff00, opacity: 0.6, transparent: true, flatShading: true, shininess: 100 }),
            mirror: new THREE.MeshStandardMaterial({ color: 0xffffff, metalness: 0.9, roughness: 0.1 }),
            glitch: new THREE.MeshBasicMaterial({ color: 0x00ff41, wireframe: true })
        };

        // Floor
        const floorGeo = new THREE.PlaneGeometry(60, 60);
        const floor = new THREE.Mesh(floorGeo, mats.floor);
        floor.rotation.x = -Math.PI / 2;
        floor.receiveShadow = true;
        scene.add(floor);

        // Helper: Create Box
        function createBox(w, h, d, x, y, z, mat, shadow = true) {
            const geo = new THREE.BoxGeometry(w, h, d);
            const mesh = new THREE.Mesh(geo, mat);
            mesh.position.set(x, y, z);
            if (shadow) {
                mesh.castShadow = true;
                mesh.receiveShadow = true;
            }
            return mesh;
        }

        // Helper: Create Plant
        function createPlant(x, z) {
            const group = new THREE.Group();
            const pot = createBox(1, 1, 1, 0, 0.5, 0, mats.wood);
            const stem = createBox(0.2, 1, 0.2, 0, 1.2, 0, new THREE.MeshStandardMaterial({color: 0x4a3b2a}));
            const leavesGeo = new THREE.IcosahedronGeometry(0.8);
            const leavesMat = new THREE.MeshStandardMaterial({ color: config.colors.plantGreen, flatShading: true });
            const leaves = new THREE.Mesh(leavesGeo, leavesMat);
            leaves.position.set(0, 2, 0);
            leaves.castShadow = true;
            
            group.add(pot);
            group.add(stem);
            group.add(leaves);
            group.position.set(x, 0, z);
            return group;
        }
        
        // Add decorative plants
        scene.add(createPlant(-10, -10));
        scene.add(createPlant(12, 12));
        scene.add(createPlant(-12, 5));

        // --- 4. STATIONS (Project Objects) ---
        const stations = [];

        // 1. Audio Corner (Jukebox)
        const s1 = new THREE.Group();
        s1.add(createBox(2, 4, 2, 0, 2, 0, new THREE.MeshStandardMaterial({color: 0x222}))); // Body
        const speaker = new THREE.Mesh(new THREE.CylinderGeometry(0.8, 0.8, 0.5, 32), mats.highlight);
        speaker.rotation.x = Math.PI/2;
        speaker.position.set(0, 2.5, 1);
        s1.add(speaker);
        s1.position.set(-8, 0, -5);
        s1.userData = { id: 'glgl', title: 'GlglStats' };
        scene.add(s1);
        stations.push(s1);

        // 2. Situation Room (Hologram Table)
        const s2 = new THREE.Group();
        s2.add(createBox(5, 1.5, 4, 0, 0.75, 0, mats.furniture)); // Table
        const holoGeo = new THREE.ConeGeometry(2, 2, 4, 1, true);
        const holo = new THREE.Mesh(holoGeo, mats.hologram);
        holo.position.set(0, 2.5, 0);
        holo.scale.set(1, -1, 1); // Point down
        
        // Animated Map bits
        for(let i=0; i<5; i++) {
            const b = createBox(0.2, Math.random()*1, 0.2, (Math.random()-0.5)*3, 1.6, (Math.random()-0.5)*2, new THREE.MeshBasicMaterial({color: 0xff3333}));
            s2.add(b);
        }
        s2.add(holo);
        s2.position.set(5, 0, -5);
        s2.userData = { id: 'ahuzat', title: 'Ahuzat Dibuk' };
        scene.add(s2);
        stations.push(s2);

        // 3. Engineering Desk (Robot Arm)
        const s3 = new THREE.Group();
        s3.add(createBox(4, 2, 2, 0, 1, 0, mats.wood)); // Desk
        // Simple Robot Arm
        const armBase = createBox(0.8, 0.2, 0.8, 1, 2.1, 0, mats.pants);
        const armLink = createBox(0.2, 1.5, 0.2, 1, 2.8, 0, mats.furniture);
        const armHead = new THREE.Mesh(new THREE.OctahedronGeometry(0.4), mats.highlight);
        armHead.position.set(0.5, 3.5, 0);
        s3.add(armBase, armLink, armHead);
        
        // Store reference for animation
        s3.userData = { id: 'orienting', title: '2D Part Orienting', animated: armHead };
        s3.position.set(10, 0, 8);
        scene.add(s3);
        stations.push(s3);

        // 4. Comedy Stage (Mic Stand)
        const s4 = new THREE.Group();
        const stage = new THREE.Mesh(new THREE.CylinderGeometry(3, 3.2, 0.5, 8), mats.floor);
        stage.position.y = 0.25;
        stage.receiveShadow = true;
        s4.add(stage);
        const micPole = createBox(0.1, 2, 0.1, 0, 1.5, 0, new THREE.MeshStandardMaterial({color: 0x111}));
        const micHead = new THREE.Mesh(new THREE.SphereGeometry(0.2), mats.skin);
        micHead.position.set(0, 2.5, 0);
        s4.add(micPole, micHead);
        // "Ha Ha" bubbles
        const textGeo = createBox(0.5, 0.2, 0.1, 1, 2, 0, mats.highlight); 
        s4.add(textGeo);
        
        s4.position.set(-5, 0, 10);
        s4.userData = { id: 'jest', title: 'The Turing Jest' };
        scene.add(s4);
        stations.push(s4);

        // 5. Printing Press (Typewriter)
        const s5 = new THREE.Group();
        s5.add(createBox(2, 1.5, 2, 0, 0.75, 0, mats.furniture)); // Stand
        const typewriter = createBox(1, 0.5, 1, 0, 1.75, 0, mats.pants);
        const paper = createBox(0.8, 1, 0.02, 0, 2.2, -0.2, new THREE.MeshStandardMaterial({color: 0xffffff}));
        paper.rotation.x = -0.2;
        s5.add(typewriter, paper);
        s5.position.set(-12, 0, 2);
        s5.userData = { id: 'rhymes', title: 'Rhymes of Israel' };
        scene.add(s5);
        stations.push(s5);

        // 6. Infinite Mirror (Server Rack)
        const s6 = new THREE.Group();
        const rack = createBox(2, 5, 2, 0, 2.5, 0, new THREE.MeshStandardMaterial({color: 0x1a1a1a}));
        const screen = createBox(1.5, 1, 0.1, 0, 3.5, 1.05, mats.mirror); // The "Mirror"
        
        // Simulated blinking server lights
        for(let j=0; j<8; j++) {
            let light = createBox(0.1, 0.1, 0.05, (Math.random()-0.5)*1.5, 1 + Math.random()*2, 1.05, new THREE.MeshBasicMaterial({color: 0x00ff00}));
            s6.add(light);
        }
        s6.add(rack, screen);
        s6.position.set(0, 0, -10); // Back center
        s6.userData = { id: 'meta', title: 'Meta-Portfolio' };
        scene.add(s6);
        stations.push(s6);

        // 7. Social Lounge
        const s7 = new THREE.Group();
        const rug = new THREE.Mesh(new THREE.CircleGeometry(3, 32), new THREE.MeshStandardMaterial({color: 0xffecb3}));
        rug.rotation.x = -Math.PI/2;
        rug.position.y = 0.02;
        const chair1 = createBox(1, 1, 1, -1, 0.5, 0, new THREE.MeshStandardMaterial({color: 0xff7043}));
        const chair2 = createBox(1, 1, 1, 1, 0.5, 0, new THREE.MeshStandardMaterial({color: 0xff7043}));
        s7.add(rug, chair1, chair2);
        
        // Floating Icons (Abstracted cubes rotating)
        const iconGroup = new THREE.Group();
        const i1 = createBox(0.5, 0.5, 0.5, -1, 0, 0, new THREE.MeshBasicMaterial({color: 0x181717})); // Github
        const i2 = createBox(0.5, 0.5, 0.5, 0, 0, 0, new THREE.MeshBasicMaterial({color: 0x0077b5})); // Linkedin
        const i3 = createBox(0.5, 0.5, 0.5, 1, 0, 0, new THREE.MeshBasicMaterial({color: 0x1877f2})); // FB
        iconGroup.add(i1, i2, i3);
        iconGroup.position.set(0, 2.5, 0);
        s7.add(iconGroup);
        s7.userData = { id: 'social', title: 'Social Lounge', icons: iconGroup };
        
        s7.position.set(0, 0, 0); // Center room
        scene.add(s7);
        stations.push(s7);


        // --- 5. THE CHARACTER (Avatar) ---
        const avatar = new THREE.Group();
        
        // Body (Hoodie)
        const body = createBox(0.8, 1.2, 0.5, 0, 0.6, 0, mats.hoodie);
        // Head
        const head = createBox(0.5, 0.6, 0.5, 0, 1.5, 0, mats.skin);
        // Hood
        const hood = createBox(0.6, 0.6, 0.6, 0, 1.55, -0.1, mats.hoodie);
        // Headphones
        const hpL = createBox(0.1, 0.3, 0.3, -0.32, 1.5, 0, new THREE.MeshStandardMaterial({color: 0x111}));
        const hpR = createBox(0.1, 0.3, 0.3, 0.32, 1.5, 0, new THREE.MeshStandardMaterial({color: 0x111}));
        const hpBand = createBox(0.7, 0.1, 0.1, 0, 1.85, 0, new THREE.MeshStandardMaterial({color: 0x111}));

        avatar.add(body, head, hood, hpL, hpR, hpBand);
        avatar.position.set(0, 0, 5); // Start position
        avatar.castShadow = true;
        scene.add(avatar);

        // --- 6. CONTROLS & PHYSICS ---
        const keys = { w: false, a: false, s: false, d: false };

        window.addEventListener('keydown', (e) => {
            if(e.key.toLowerCase() in keys) keys[e.key.toLowerCase()] = true;
            if(e.code === 'Space' && state.activeStation) openModal(state.activeStation);
        });
        window.addEventListener('keyup', (e) => {
            if(e.key.toLowerCase() in keys) keys[e.key.toLowerCase()] = false;
        });

        // Mouse interaction for clicking
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();

        window.addEventListener('mousedown', (e) => {
            if(!state.activeStation) return;
            
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            
            // Allow clicking to trigger modal if proximity is good
            openModal(state.activeStation);
        });


        // --- 7. DATA CONTENT (The Specifications) ---
        const projectData = {
            'glgl': `
                <span class="project-tag">Data Analysis & Python</span>
                <h2>GlglStats: The Beat of Israel</h2>
                <div class="video-wrapper">
                    <iframe src="https://www.youtube.com/embed/jrKAtOsj1Lo" frameborder="0" allowfullscreen></iframe>
                </div>
                <p>Analyzing Israeli pop music using LZ77 compression and Python. This project visualizes repetition patterns in songs from the Galgalatz charts.</p>
                <a href="https://glglstats.geekip.dev" target="_blank" class="btn">Launch Project</a>
            `,
            'ahuzat': `
                <span class="project-tag">Big Data & Visualization</span>
                <h2>Ahuzat Dibuk: Tel-Aviv Parking Map</h2>
                <p>An automated pipeline scraping Tel-Aviv municipal data to generate real-time parking heatmaps.</p>
                <div style="display:flex; gap:10px; margin: 15px 0;">
                    <div style="flex:1; height:60px; background:linear-gradient(90deg, #ff0000, #00ff00); border-radius:4px;"></div>
                </div>
                <h3>In The News:</h3>
                <ul style="opacity:0.8; font-size:0.9rem;">
                   <li><a href="https://13tv.co.il/item/news/domestic/internal/parking-902956407/" target="_blank">Channel 13 Coverage</a></li>
                   <li><a href="https://www.mako.co.il/nexter-news/Article-ae43964b891bf71027.htm" target="_blank">Mako News</a></li>
                   <li><a href="https://www.facebook.com/groups/secrettelaviv/posts/10159636301195943" target="_blank">Original Viral Post</a></li>
                </ul>
            `,
            'orienting': `
                <span class="project-tag">C++ & Computational Geometry</span>
                <h2>2D Part Orienting</h2>
                <p>A C++ implementation of algorithms for sensorless manipulation. The system computes the optimal sequence of fence rotations to orient a polygonal part into a known position.</p>
                <div style="background:#eee; padding:10px; border-radius:4px; font-family:monospace; margin:10px 0;">
                    std::vector&lt;Edge&gt; computeSeq(Polygon p);
                </div>
                <a href="https://www.cgl.cs.tau.ac.il/projects/2d-part-orienting/" target="_blank" class="btn">View Algorithm</a>
            `,
            'jest': `
                <span class="project-tag">LLM & Fullstack</span>
                <h2>The Turing Jest</h2>
                <p>Can AI be funny? An LLM-powered pun competition where AI models generate jokes based on prompts and users rate them in an arena-style face-off.</p>
                <p style="font-style:italic;">"Why did the developer go broke? Because he used up all his cache."</p>
                <a href="https://jest.geekip.dev" target="_blank" class="btn">Start Laughing</a>
            `,
            'rhymes': `
                <span class="project-tag">Chrome Extension</span>
                <h2>Rhymes of Israel</h2>
                <p>Brings joy to browsing news sites by converting boring headlines into yearbook-style rhymes instantly.</p>
                <div style="display:flex; justify-content:space-between; background:#222; color:#fff; padding:10px; border-radius:4px; margin:10px 0;">
                    <span>"Politics Update"</span> <span>‚Üí</span> <span style="color:#ffcc00">"Politics is great!"</span>
                </div>
                <a href="https://chromewebstore.google.com/detail/eainginjgdkpgolpjniijdihfbeeeklb" target="_blank" class="btn">Get Extension</a>
            `,
            'meta': `
                <span class="project-tag">Web 3D</span>
                <h2>Meta-Portfolio</h2>
                <p>You are looking at it. This low-poly world is rendered in real-time in your browser.</p>
                <a href="https://geekip.dev" class="btn">Recursion (Refresh)</a>
            `,
            'social': `
                <span class="project-tag">Connect</span>
                <h2>The Social Lounge</h2>
                <p>Let's build something together.</p>
                <div class="floating-icons" style="margin-top:20px; text-align:center;">
                    <a href="https://github.com/gevak" target="_blank">üê± GitHub</a>
                    <a href="https://linkedin.com/in/gevakip" target="_blank">üíº LinkedIn</a>
                    <a href="https://facebook.com/geva.kipper" target="_blank">üìò Facebook</a>
                </div>
            `
        };

        // --- 8. GAME & UI LOGIC ---

        const promptEl = document.getElementById('interact-prompt');
        const modal = document.getElementById('project-modal');
        const modalBody = document.getElementById('modal-body');

        function openModal(station) {
            state.canMove = false;
            const content = projectData[station.userData.id];
            modalBody.innerHTML = content;
            modal.style.display = 'flex';
        }

        window.closeModal = function() { // Global scope for onClick
            modal.style.display = 'none';
            state.canMove = true;
        }

        // Singularity Timer
        const targetDate = new Date("2026-01-08T01:12:48").getTime();
        const timerEl = document.getElementById('singularity-timer');

        function updateTimer() {
            const now = new Date().getTime();
            const delta = targetDate - now;

            const isFuture = delta > 0;
            const absDelta = Math.abs(delta);
            
            const hours = Math.floor((absDelta % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((absDelta % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((absDelta % (1000 * 60)) / 1000);
            
            // Formatting with leading zeros
            const h = hours.toString().padStart(2, '0');
            const m = minutes.toString().padStart(2, '0');
            const s = seconds.toString().padStart(2, '0');
            
            // To simulate "Time SINCE" for a future date, we display it as a negative countdown
            timerEl.innerText = `Time since Singularity: -${Math.floor(absDelta/(1000*60*60*24))}d ${h}:${m}:${s}`;
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // --- 9. ANIMATION LOOP ---

        function animate(time) {
            requestAnimationFrame(animate);

            // Movement Logic
            if(state.canMove) {
                const moveVec = new THREE.Vector3(0, 0, 0);
                // Isometric conversion: W moves -Z-X (Upper Left), S moves +Z+X ...
                // Actually, let's keep it simple relative to screen up/down/left/right
                // In Isometric: Up is (-1, 0, -1), Right is (1, 0, -1) roughly
                
                if(keys.w) moveVec.z -= 1;
                if(keys.s) moveVec.z += 1;
                if(keys.a) moveVec.x -= 1;
                if(keys.d) moveVec.x += 1;

                if(moveVec.length() > 0) {
                    moveVec.normalize().multiplyScalar(config.speed);
                    
                    const nextPos = avatar.position.clone().add(moveVec);
                    
                    // Simple Bounds check (Room Size 60x60)
                    if(nextPos.x > -25 && nextPos.x < 25 && nextPos.z > -25 && nextPos.z < 25) {
                        avatar.position.add(moveVec);
                        // Rotate character to face movement
                        const targetLook = avatar.position.clone().add(moveVec);
                        avatar.lookAt(targetLook);
                    }
                }
            }

            // Proximity Check
            let closestDist = Infinity;
            let closestStation = null;

            stations.forEach(station => {
                const dist = avatar.position.distanceTo(station.position);
                
                // Animation of specific station parts
                if(station.userData.id === 'orienting') {
                    station.userData.animated.rotation.y += 0.02;
                    station.userData.animated.rotation.z = Math.sin(time * 0.002) * 0.5;
                }
                if(station.userData.id === 'social') {
                    station.userData.icons.rotation.y = time * 0.001;
                }

                if(dist < closestDist) {
                    closestDist = dist;
                    closestStation = station;
                }
            });

            if(closestDist < config.interactionDist) {
                state.activeStation = closestStation;
                promptEl.style.display = 'block';
                promptEl.innerText = `Press SPACE: ${closestStation.userData.title}`;
                
                // Head tracking look at nearby station
                const head = avatar.children[1];
                if(head) {
                    const localPos = closestStation.position.clone().sub(avatar.position);
                    // simple approximate look logic for head bone
                    // Actually simple mesh rotation is easier
                    // Not implemented to keep code simple, full body LookAt used in movement
                }
            } else {
                state.activeStation = null;
                promptEl.style.display = 'none';
            }

            // Camera Follow System (Smooth Lerp)
            const targetCamPos = new THREE.Vector3(
                avatar.position.x + 20, 
                avatar.position.y + 20, 
                avatar.position.z + 20
            );
            camera.position.lerp(targetCamPos, 0.05);
            camera.lookAt(avatar.position);

            renderer.render(scene, camera);
        }

        // Handle Resize
        window.addEventListener('resize', () => {
            const aspect = window.innerWidth / window.innerHeight;
            camera.left = -d * aspect;
            camera.right = d * aspect;
            camera.top = d;
            camera.bottom = -d;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate(0);

    </script>
<!-- Add this block to embed the like button -->
    <script src="/static/js/like_button.js"></script>
    <script>
        LikeButton.init({
          pageId: "20260108",
          position: "bottom-right", // Options: bottom-right, bottom-left, top-right, top-left
        });
    </script>

</body>
</html>